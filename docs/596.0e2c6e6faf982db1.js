"use strict";(self.webpackChunkInvFurniture=self.webpackChunkInvFurniture||[]).push([[596],{7915:(D,P,m)=>{m.d(P,{U:()=>F});var t=m(4650),g=m(4985),v=m(8179),e=m(4006),h=m(6895),p=m(2121);function Z(s,f){if(1&s&&(t.TgZ(0,"option",14),t._uU(1),t.qZA()),2&s){const r=f.$implicit;t.Q6J("ngValue",r),t.xp6(1),t.hij(" ",r," ")}}const d=function(s){return{"is-invalid":s}};function b(s,f){if(1&s&&(t.TgZ(0,"select",11)(1,"option",12),t._uU(2,"Seleccione una opcion"),t.qZA(),t.YNc(3,Z,2,2,"option",13),t.qZA()),2&s){const r=t.oxw().$implicit,c=t.oxw(2);t.Q6J("id",r.label)("name",r.label)("ngClass",t.VKq(6,d,(c.f[r.label].touched||c.submitted)&&c.f[r.label].errors))("formControlName",r.label),t.xp6(1),t.Q6J("ngValue",null),t.xp6(2),t.Q6J("ngForOf",r.value)}}function T(s,f){if(1&s&&t._UZ(0,"input",15),2&s){const r=t.oxw().$implicit,c=t.oxw(2);t.Tol("form-control"+r.classlist),t.Q6J("formControlName",r.label)("id",r.label)("name",r.label)("type",r.type)("placeholder",r.placeholder)("value",r.valueCallback?r.getValue():r.value)("ngClass",t.VKq(10,d,(c.f[r.label].touched||c.submitted)&&c.f[r.label].errors))("readonly",c.mode||r.readonly)}}function M(s,f){1&s&&(t.TgZ(0,"div"),t._uU(1,"El Email es invalido"),t.qZA())}function w(s,f){if(1&s&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&s){const r=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",r.placeholder," es requerido ")}}function y(s,f){if(1&s&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&s){const r=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",r.placeholder," debe estar seleccionado ")}}function A(s,f){if(1&s&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&s){const r=t.oxw(2).$implicit;t.xp6(1),t.hij(" ",r.placeholder," no tiene el patron requerido ")}}function O(s,f){if(1&s&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&s){const r=t.oxw(2).$implicit,c=t.oxw(2);t.xp6(1),t.AsE(" ",r.placeholder," debe tener almenos ",c.f[r.label].errors.minlength.requiredLength," caracteres ")}}function I(s,f){if(1&s&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&s){const r=t.oxw(2).$implicit,c=t.oxw(2);t.xp6(1),t.AsE(" ",r.placeholder," debe tener menos de ",c.f[r.label].errors.maxlength.requiredLength," caracteres ")}}function J(s,f){if(1&s&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&s){const r=t.oxw(2).$implicit,c=t.oxw(2);t.xp6(1),t.AsE(" ",r.placeholder," debe tener menos de ",c.f[r.label].errors.maxlength.requiredLength," caracteres ")}}function N(s,f){if(1&s&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&s){const r=t.oxw(2).$implicit,c=t.oxw(2);t.xp6(1),t.AsE(" ",r.placeholder," ",c.f[r.label].errors.custom,"")}}function U(s,f){if(1&s&&(t.TgZ(0,"div",16),t.YNc(1,M,2,0,"div",17),t.YNc(2,w,2,1,"div",17),t.YNc(3,y,2,1,"div",17),t.YNc(4,A,2,1,"div",17),t.YNc(5,O,2,2,"div",17),t.YNc(6,I,2,2,"div",17),t.YNc(7,J,2,2,"div",17),t.YNc(8,N,2,2,"div",17),t.qZA()),2&s){const r=t.oxw().$implicit,c=t.oxw(2);t.xp6(1),t.Q6J("ngIf",c.f[r.label].errors.email),t.xp6(1),t.Q6J("ngIf",c.f[r.label].errors.required),t.xp6(1),t.Q6J("ngIf",c.f[r.label].errors.requiredTrue),t.xp6(1),t.Q6J("ngIf",c.f[r.label].errors.pattern),t.xp6(1),t.Q6J("ngIf",c.f[r.label].errors.minlength),t.xp6(1),t.Q6J("ngIf",c.f[r.label].errors.maxlength),t.xp6(1),t.Q6J("ngIf",c.f[r.label].errors.maxlength),t.xp6(1),t.Q6J("ngIf",c.f[r.label].errors.custom)}}function q(s,f){1&s&&t._UZ(0,"div",18)}function E(s,f){if(1&s&&(t.TgZ(0,"div",5),t.YNc(1,b,4,8,"select",6),t.YNc(2,T,1,12,"input",7),t.TgZ(3,"label",8),t._uU(4),t.qZA(),t.YNc(5,U,9,8,"div",9),t.YNc(6,q,1,0,"div",10),t.qZA()),2&s){const r=f.$implicit,c=t.oxw(2);t.xp6(1),t.Q6J("ngIf","select"==r.type),t.xp6(1),t.Q6J("ngIf","select"!=r.type),t.xp6(1),t.Q6J("for",r.label),t.xp6(1),t.hij("",r.placeholder," "),t.xp6(1),t.Q6J("ngIf",c.f[r.label].errors),t.xp6(1),t.Q6J("ngIf","radio"==r.type)}}function L(s,f){if(1&s&&(t.TgZ(0,"div",3),t.YNc(1,E,7,6,"div",4),t.qZA()),2&s){const r=f.$implicit;t.xp6(1),t.Q6J("ngForOf",r)}}function Q(s,f){if(1&s){const r=t.EpF();t.TgZ(0,"div",19)(1,"app-warn-modal",20),t.NdJ("continue",function(_){t.CHM(r);const C=t.oxw();return t.KtG(C.onSubmit(_))})("modalMessage",function(){t.CHM(r);const _=t.oxw();return t.KtG(_.modalMessage)}),t.qZA(),t.TgZ(2,"button",21),t.NdJ("click",function(){t.CHM(r);const _=t.oxw();return t.KtG(_.onReset())}),t._uU(3," Resetear "),t.qZA()()}if(2&s){const r=t.oxw();t.xp6(1),t.Q6J("btnMessage",r.btnMes)}}let F=(()=>{class s{constructor(r,c){this.cdref=r,this.fb=c,this.formModel=new t.vpe,this.reject=new t.vpe,this.mode=!1,this.showBtns=!0,this.btnMes="Registrar",this.modalMessage="\xbf Desea continuar con este proceso ? ",this.formObj=[[new g.O("Nombre Completo","fullname","text"),new g.O("Nombre de Usuario","username","text")],[new g.O("Correo Electronico","email","text")],[new g.O("Password","password","password"),new g.O("Confirmar Password","Confirm Password","password")],[new g.O("Aceptar los Terminos","Accept Terms","radio",[],"form-check-input",!1)]],this.continue=!1,this.submitted=!1,this.firstCall=!0}ngOnInit(){var r={};r=this.formObj.flat().reduce((c,_)=>{if(this.placeHolder){var C=this.placeHolder[_.getLabel()];C instanceof v.EK&&(C=this.formatDateString(C.toDate().toLocaleDateString())),_.control?.patchValue(C)}return this.mode&&_.control?.clearValidators(),c[_.label]=_.control,c},r),this._form=this.fb.group(r)}get f(){return this._form.controls}onContinue(r){this.continue=r}initPlaceHolder(){this.placeHolder&&this.formObj.forEach(r=>r.forEach(c=>{if(this.placeHolder){var _=this.placeHolder[c.getLabel()];_ instanceof v.EK&&(_=this.formatDateString(_.toDate().toLocaleDateString())),this.f[c.getLabel()].patchValue(_)}}))}ngOnChanges(){this.firstCall||this.initPlaceHolder(),this.firstCall=!1}formatDateString(r){return r.split("/").reverse().join("/").replace(/\//g,"-")}ngAfterContentChecked(){this.cdref.detectChanges()}onSubmit(r){this.submitted=!0,!this._form.invalid&&this.formModel.emit(this._form.getRawValue())}onReset(){this._form.reset(),this.continue=!1,this.submitted=!1}}return s.\u0275fac=function(r){return new(r||s)(t.Y36(t.sBO),t.Y36(e.j3))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-form"]],inputs:{placeHolder:"placeHolder",mode:"mode",showBtns:"showBtns",btnMes:"btnMes",modalMessage:"modalMessage",formObj:"formObj"},outputs:{formModel:"formModel",reject:"reject"},features:[t.TTD],decls:3,vars:3,consts:[["name","form",3,"formGroup","ngSubmit"],["class","input-group mb-2",4,"ngFor","ngForOf"],["class","form-group mt-3",4,"ngIf"],[1,"input-group","mb-2"],["class","form-floating",4,"ngFor","ngForOf"],[1,"form-floating"],["class","form-select",3,"id","name","ngClass","formControlName",4,"ngIf"],["oninput","this.value = this.value.toLowerCase()","min","1","step","1",3,"formControlName","class","id","name","type","placeholder","value","ngClass","readonly",4,"ngIf"],[1,"",3,"for"],["class","invalid-feedback",4,"ngIf"],["class","mb-4",4,"ngIf"],[1,"form-select",3,"id","name","ngClass","formControlName"],["disabled","",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],["oninput","this.value = this.value.toLowerCase()","min","1","step","1",3,"formControlName","id","name","type","placeholder","value","ngClass","readonly"],[1,"invalid-feedback"],[4,"ngIf"],[1,"mb-4"],[1,"form-group","mt-3"],["id","1","name","btn1","type","submit",3,"btnMessage","continue","modalMessage"],["type","button",1,"ms-2","btn","btn-outline-primary","rounded-pill",3,"click"]],template:function(r,c){1&r&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return c.onContinue(!0)}),t.YNc(1,L,2,1,"div",1),t.YNc(2,Q,4,1,"div",2),t.qZA()),2&r&&(t.Q6J("formGroup",c._form),t.xp6(1),t.Q6J("ngForOf",c.formObj),t.xp6(1),t.Q6J("ngIf",!c.mode&&c.showBtns))},dependencies:[h.mk,h.sg,h.O5,e._Y,e.YN,e.Kr,e.Fj,e.EJ,e.JJ,e.JL,e.sg,e.u,p.u]}),s})()},4985:(D,P,m)=>{m.d(P,{O:()=>v});var t=m(4006),g=m(8505);class v{constructor(h,p,Z,d=[t.kI.required],b,T,M,w,y=!1){this.value=b,this.label=p,this.type=Z,this.placeholder=h,this.classlist=T||" ",this.ref=w||void 0,this.valueCallback=M,this.readonly=y,d.push(t.kI.required),this.control=new t.NI({value:null,disabled:y},d),this.respondTo$=this.control.valueChanges.pipe((0,g.b)({next:M,error:A=>console.log(A),complete:()=>console.log("Completed")}))}setReadOnly(h){return this.readonly=h,this}setValue(h){return this.value=h,this}getValue(){this.value=this.ref?this.valueCallback(...this.ref.map(h=>h.value)):this.valueCallback()}getLabel(){return this.label}}},2596:(D,P,m)=>{m.r(P),m.d(P,{ProductModule:()=>G});var t=m(6895),g=m(2827),v=m(6535),e=m(4650),h=m(3651),p=m(4006),Z=m(5748),d=m(4985),b=m(7915),T=m(727),M=m(8505),w=m(1350),y=m(33);let A=(()=>{class n{constructor(o){this.db=o,this.dbPath="/products",this.productsRef=o.collection(this.dbPath)}getById(o){return this.productsRef.doc(o).get()}getNextBatch(o,i){return this.db.collection(this.dbPath,i?a=>a.orderBy("timestamp","desc").startAfter(i.timestamp).limit(o):a=>a.orderBy("timestamp","desc").limit(o))}getPrevBatch(o,i,a){return this.db.collection(this.dbPath,l=>l.orderBy("timestamp","desc").startAt(i).endBefore(a).limit(o))}getBatch(o){return this.db.collection(this.dbPath,i=>i.limit(o).orderBy("timestamp","desc"))}getAll(){return this.productsRef}create(o){return this.productsRef.add({...o})}update(o,i){return this.productsRef.doc(o).update(i)}delete(o){return this.productsRef.doc(o).delete()}filterByNameBatch(o,i,a){return this.db.collection(this.dbPath,a?l=>l.where("name",">=",o).where("name","<=",o+"\uf8ff").orderBy("name","desc").startAfter(a.name).limit(i):l=>l.where("name",">=",o).where("name","<=",o+"\uf8ff").orderBy("name","desc").limit(i))}filterByCodeBatch(o,i,a){return this.db.collection(this.dbPath,a?l=>l.where("code",">=",o).where("code","<=",o+"\uf8ff").orderBy("code","desc").startAfter(a.code).limit(i):l=>l.where("code",">=",o).where("code","<=",o+"\uf8ff").orderBy("code","desc").limit(i))}filterByName(o){return this.db.collection(this.dbPath,i=>i.where("name",">=",o).where("name","<=",o+"\uf8ff"))}filterByCode(o){return this.db.collection(this.dbPath,i=>i.where("code",">=",o).where("code","<=",o+"\uf8ff"))}}return n.\u0275fac=function(o){return new(o||n)(e.LFG(y.ST))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var O=m(9898);function I(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"button",6),e.NdJ("click",function(){e.CHM(o);const a=e.oxw(2);return e.KtG(a.deleteProduct())}),e._uU(1," Eliminar "),e.qZA()}}function J(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"div",2)(1,"h4"),e._uU(2,"Producto"),e.qZA(),e.TgZ(3,"app-form",3),e.NdJ("formModel",function(a){e.CHM(o);const l=e.oxw();return e.KtG(l.submit(a))}),e.qZA(),e.YNc(4,I,2,0,"button",4),e.TgZ(5,"button",5),e._uU(6," Materiales "),e.qZA(),e.TgZ(7,"p"),e._uU(8),e.qZA()()}if(2&n){const o=e.oxw();e.xp6(3),e.Q6J("formObj",o.formObj)("mode",!o.userRole)("placeHolder",o.currentProduct),e.xp6(1),e.Q6J("ngIf",o.userRole),e.xp6(1),e.Q6J("state",o.currentProduct),e.xp6(3),e.Oqu(o.message)}}function N(n,u){1&n&&(e.TgZ(0,"div"),e._UZ(1,"br"),e.TgZ(2,"p"),e._uU(3,"No fue posible acceder a este producto..."),e.qZA()())}let U=(()=>{class n{constructor(o,i,a){this.productService=o,this.auth=i,this.FpService=a,this.refreshList=new e.vpe,this.currentProduct={name:"",description:"",code:"",price:0,leadTime:0,stock:0,capacityByTurn:0},this.message="",this.onLeadTime$=new T.w0,this.round=l=>Math.round(100*l)/100,this.auth.user$.subscribe(l=>this.userRole=l?.userRole),this.formObj=[[new d.O("Nombre","name","text").setReadOnly(!0),new d.O("Codigo","code","text")],[new d.O("Descripcion","description","text")],[new d.O("Volumen","volume","number",[this.custom]),new d.O("Peso","weight","number",[this.custom]),new d.O("Unidad de Medida","units","text")],[new d.O("Precio","price","number",[this.custom]),new d.O("Tipo IVA","iva","number",[this.custom]),new d.O("Divisa","currency","select")],[new d.O("Cantidad en Inventario","stock","number"),new d.O("Unidad de CFDI","cfdiUnit","text"),new d.O("Unidad de CFDI","cfdiKey","text"),new d.O("SKU","sku","text")],[new d.O("No Producto","noproduct","number"),new d.O("Capacidad por turno","capacityByTurn","number",[this.custom]),new d.O("Tiempo de Produccion","leadTime","number").setReadOnly(!0)]]}ngAfterViewInit(){this.onLeadTime$=this.formC.f.capacityByTurn.valueChanges.pipe((0,M.b)(o=>this.formC.f.leadTime.patchValue(this.round(1/o)))).subscribe()}ngOnInit(){this.message=""}custom(o){return o.value>0||null==o.value?null:{custom:"debe ser positivo"}}ngOnChanges(){this.message="",this.currentProduct={...this.product}}submit(o){this.currentProduct=o,this.updateProduct()}onNgDestory(){this.onLeadTime$.unsubscribe()}updateProduct(){const{stock:o,...i}=this.currentProduct;this.currentProduct.id&&(0,w.z)(this.productService.update(this.currentProduct.id,i),this.FpService.update(this.currentProduct.invId,{available:o})).subscribe({complete:()=>{this.refreshList.emit(),this.message="El producto fue actualizado satisfactoriamente!"},error:a=>alert("Ah ocurrido un error inesperado, intente de nuevo o recargue la p\xe1gina.")})}deleteProduct(){this.currentProduct.id&&this.productService.delete(this.currentProduct.id).then(()=>{this.refreshList.emit(),this.message="El producto fue eliminado satisfactoriamente!"}).catch(o=>console.log(o))}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(A),e.Y36(h.e),e.Y36(O.L))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-product-details"]],viewQuery:function(o,i){if(1&o&&e.Gf(b.U,5),2&o){let a;e.iGM(a=e.CRH())&&(i.formC=a.first)}},inputs:{product:"product"},outputs:{refreshList:"refreshList"},features:[e.TTD],decls:2,vars:2,consts:[["class","edit-form",4,"ngIf"],[4,"ngIf"],[1,"edit-form"],["btnMes","Editar Material","modalMessage","\xbfSeguro que desea editar el producto?",3,"formObj","mode","placeHolder","formModel"],["class","ms-2 btn btn-danger rounded-pill",3,"click",4,"ngIf"],["routerLink","material",1,"ms-2","btn","btn-secondary","rounded-pill",3,"state"],[1,"ms-2","btn","btn-danger","rounded-pill",3,"click"]],template:function(o,i){1&o&&(e.YNc(0,J,9,6,"div",0),e.YNc(1,N,4,0,"div",1)),2&o&&(e.Q6J("ngIf",i.currentProduct),e.xp6(1),e.Q6J("ngIf",!i.currentProduct))},dependencies:[t.O5,g.rH,b.U]}),n})();function q(n,u){1&n&&(e.TgZ(0,"button",14),e.O4$(),e.TgZ(1,"svg",15),e._UZ(2,"g",16)(3,"g",17),e.TgZ(4,"g",18)(5,"g"),e._UZ(6,"path",19),e.qZA()()()())}function E(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"div")(1,"app-product-details",20),e.NdJ("refreshList",function(){e.CHM(o);const a=e.oxw();return e.KtG(a.refreshList())}),e.qZA()()}if(2&n){const o=e.oxw();e.xp6(1),e.Q6J("product",o.currentProduct)}}function L(n,u){1&n&&(e.TgZ(0,"div"),e._UZ(1,"br"),e.TgZ(2,"p"),e._uU(3,"Seleccione un producto..."),e.qZA()())}let Q=(()=>{class n{constructor(o){this.auth=o,this.title="",this.q="",this.query="",this.codeFilter=!1,this.userRole="a"}ngOnInit(){}refreshList(){this.currentProduct=void 0}filter(){this.q=this.codeFilter?{key:"code",value:this.query}:this.query,this.refreshList()}getSelectedElement(o){this.currentProduct=o.element}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(h.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-product-list"]],features:[e._Bn([v.U,{provide:"path",useValue:"/products"}])],decls:20,vars:7,consts:[[1,"container","mt-5","vh-100"],["role","search",1,"d-flex"],[1,"text-muted","text-nowrap"],[1,"ms-5","form-check"],["for","flexCheckDefault",1,"form-check-label"],["type","checkbox","id","flexCheckDefault","name","codeFilter",1,"form-check-input",3,"ngModel","ngModelChange"],["id","query","type","search","oninput","this.value = this.value.toLowerCase()","name","query","placeholder","Buscar por Nombre o Codigo","aria-label","Search",1,"form-control","ms-2","me-2","float-end",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-outline-success","float-end",3,"click"],[1,"position-fixed","bottom-0","end-0",2,"margin","6rem","z-index","1070"],["class","btn btn-success btn-lg rounded-pill","routerLink","add",4,"ngIf"],[1,"list","row","shadow-sm"],[1,"col-md-6"],[3,"path","query","selectedElement"],[4,"ngIf"],["routerLink","add",1,"btn","btn-success","btn-lg","rounded-pill"],["fill","#ffffff","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","4vh","height","4vh","viewBox","0 0 47 47",0,"xml","space","preserve","stroke","#ffffff"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["d","M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141 c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27 c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435 c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z"],[3,"product","refreshList"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"form",1)(2,"h4",2),e._uU(3,"Lista de Productos"),e.qZA(),e.TgZ(4,"div",3)(5,"label",4),e._uU(6," Filtro por Codigo "),e.qZA(),e.TgZ(7,"input",5),e.NdJ("ngModelChange",function(l){return i.codeFilter=l}),e.qZA()(),e.TgZ(8,"input",6),e.NdJ("ngModelChange",function(l){return i.query=l}),e.qZA(),e.TgZ(9,"button",7),e.NdJ("click",function(){return i.filter()}),e._uU(10,"Buscar"),e.qZA()(),e._UZ(11,"hr"),e.TgZ(12,"div",8),e.YNc(13,q,7,0,"button",9),e.qZA(),e.TgZ(14,"div",10)(15,"div",11)(16,"app-pagination",12),e.NdJ("selectedElement",function(l){return i.getSelectedElement(l)}),e.qZA()(),e.TgZ(17,"div",11),e.YNc(18,E,2,1,"div",13),e.YNc(19,L,4,0,"div",13),e.qZA()()()),2&o&&(e.xp6(7),e.Q6J("ngModel",i.codeFilter),e.xp6(1),e.Q6J("ngModel",i.query),e.xp6(5),e.Q6J("ngIf",i.userRole),e.xp6(3),e.Q6J("path","/products")("query",i.q),e.xp6(2),e.Q6J("ngIf",i.currentProduct),e.xp6(1),e.Q6J("ngIf",!i.currentProduct))},dependencies:[t.O5,g.rH,p._Y,p.Fj,p.Wl,p.JJ,p.JL,p.On,p.F,Z.Q,U]}),n})();class F{}var s=m(8179),f=m(798);function r(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"div")(1,"div",4)(2,"div",5)(3,"app-form",6),e.NdJ("formModel",function(a){e.CHM(o);const l=e.oxw();return e.KtG(l.submit(a))}),e.qZA()()()()}if(2&n){const o=e.oxw();e.xp6(3),e.Q6J("formObj",o.formObj)("mode",!o.userRole)}}function c(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"div",7)(1,"h4"),e._uU(2,"El producto a sido registrado Satisfactoriamente!"),e.qZA(),e.TgZ(3,"button",8),e.NdJ("click",function(){e.CHM(o);const a=e.oxw();return e.KtG(a.newProduct())}),e._uU(4,"A\xf1adir Otro"),e.qZA()()}}function C(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"div",14)(1,"select",15),e.NdJ("ngModelChange",function(a){e.CHM(o);const l=e.oxw();return e.KtG(l.q=a)}),e.TgZ(2,"option",16),e._uU(3,"Seleccione Inventario"),e.qZA(),e.TgZ(4,"option",17),e._uU(5,"CORTE Y ENSAMBLE"),e.qZA(),e.TgZ(6,"option",18),e._uU(7,"CONSUMIBLE"),e.qZA(),e.TgZ(8,"option",19),e._uU(9,"CARPINTERIA"),e.qZA()(),e.TgZ(10,"label",20),e._uU(11,"Inventario"),e.qZA()()}if(2&n){const o=e.oxw();e.xp6(1),e.Q6J("ngModel",o.q),e.xp6(1),e.Q6J("ngValue",void 0)}}function B(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"input",21),e.NdJ("ngModelChange",function(a){e.CHM(o);const l=e.oxw();return e.KtG(l.q=a)}),e.qZA()}if(2&n){const o=e.oxw();e.Q6J("ngModel",o.q)}}function S(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"div",22)(1,"app-pagination",23),e.NdJ("selectedElement",function(a){e.CHM(o);const l=e.oxw();return e.KtG(l.getSelectedElement(a))}),e.qZA()()}if(2&n){const o=e.oxw();e.xp6(1),e.Q6J("path","/materials")("query",o.queryChange)}}function Y(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"li",29)(1,"div",30)(2,"span",31),e._uU(3),e.qZA(),e.TgZ(4,"div",32)(5,"input",33),e.NdJ("ngModelChange",function(a){const x=e.CHM(o).$implicit;return e.KtG(x.quantity=a)}),e.qZA(),e.TgZ(6,"span",34),e._uU(7,"U"),e.qZA()(),e.TgZ(8,"button",35),e.NdJ("click",function(){const l=e.CHM(o).index,x=e.oxw(2);return e.KtG(x.removeMaterialToProduct(l))}),e.qZA()()()}if(2&n){const o=u.$implicit;e.xp6(3),e.hij(" ",o.name," "),e.xp6(2),e.Q6J("ngModel",o.quantity)}}function R(n,u){if(1&n){const o=e.EpF();e.TgZ(0,"button",36),e.NdJ("click",function(){e.CHM(o);const a=e.oxw(2);return e.KtG(a.editMaterials())}),e._uU(1," Agregar Matriales "),e.qZA()}}function k(n,u){if(1&n&&(e.TgZ(0,"div",24)(1,"h4"),e._uU(2,"Producto"),e.qZA(),e.TgZ(3,"h3",25),e._uU(4),e.qZA(),e.TgZ(5,"p"),e._uU(6,"Materiales del Producto: "),e.qZA(),e.TgZ(7,"ul",26),e.YNc(8,Y,9,2,"li",27),e.qZA(),e.YNc(9,R,2,0,"button",28),e.qZA()),2&n){const o=e.oxw();e.xp6(4),e.AsE("",o.product.name," - ",o.product.code,""),e.xp6(4),e.Q6J("ngForOf",o.productMaterials),e.xp6(1),e.Q6J("ngIf",o.userRole)}}function V(n,u){1&n&&(e.TgZ(0,"div"),e._UZ(1,"br"),e.TgZ(2,"p"),e._uU(3,"No fue posible acceder a este producto..."),e.qZA()())}function K(n,u){1&n&&(e.TgZ(0,"div"),e._UZ(1,"br"),e.TgZ(2,"p"),e._uU(3,"Seleccione un producto..."),e.qZA()())}const j=[{path:"",component:Q},{path:"add",component:(()=>{class n{constructor(o,i,a,l){this.invFpService=o,this.auditService=i,this.fos=a,this.auth=l,this.product=new F,this.submitted=!1,this.username="anonimo",this.onLeadTime$=new T.w0,this.round=x=>Math.round(100*x)/100,this.auth.user$.subscribe(x=>{this.username=x?.displayName,this.userRole=x?.userRole}),this.formObj=[[new d.O("Nombre","name","text"),new d.O("Codigo","code","text")],[new d.O("Descripcion","description","text")],[new d.O("Volumen","volume","number",[this.custom]),new d.O("Peso","weight","number",[this.custom]),new d.O("Unidad de Medida","units","text")],[new d.O("Precio","price","number",[this.custom]),new d.O("Tipo IVA","iva","number",[this.custom]),new d.O("Divisa","currency","select",[],["MXN","USD"])],[new d.O("Cantidad en Inventario","stock","number"),new d.O("Unidad de CFDI","cfdiUnit","text"),new d.O("Unidad de CFDI","cfdiKey","text"),new d.O("SKU","sku","text")],[new d.O("No Producto","noproduct","number"),new d.O("Capacidad por turno","capacityByTurn","number",[this.custom]),new d.O("Tiempo de Produccion","leadTime","number").setReadOnly(!0)]]}ngAfterViewInit(){this.onLeadTime$=this.formC.f.capacityByTurn.valueChanges.pipe((0,M.b)(o=>this.formC.f.leadTime.patchValue(this.round(1/o)))).subscribe()}custom(o){return o.value>0||null==o.value?null:{custom:"debe ser positivo"}}submit(o){this.product=o,this.saveProduct()}saveProduct(){this.product.timestamp=s.EK.fromDate(new Date);var{stock:o,...i}=this.product;this.invFpService.create({available:+(o??0),name:i.name,commited:0,wating:0,timestamp:s.EK.fromDate(new Date)}).then(a=>{i.invId=a.id,this.fos.create(i,a.id),this.auditService.create(O.L.name,`Crear Producto: ${this.product.name}`,this.username??"anonimo",JSON.stringify({available:+(o??0),name:i.name,commited:0,wating:0,timestamp:s.EK.fromDate(new Date)})),this.submitted=!0})}onNgDestory(){this.onLeadTime$.unsubscribe()}newProduct(){this.submitted=!1,this.product=new F}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(O.L),e.Y36(f.C),e.Y36(v.U),e.Y36(h.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-product"]],viewQuery:function(o,i){if(1&o&&e.Gf(b.U,5),2&o){let a;e.iGM(a=e.CRH())&&(i.formC=a.first)}},features:[e._Bn([v.U,{provide:"path",useValue:"/products"}])],decls:6,vars:2,consts:[[1,"container","vh-100"],[1,"text-muted","mt-5"],[4,"ngIf"],["class","mt-3",4,"ngIf"],[1,"card","mt-4","bg-light","shadow-lg","border-0"],[1,"card-body"],["btnMes","Crear Producto","modalMessage","\xbfDesea continuar con la creacion del producto?",3,"formObj","mode","formModel"],[1,"mt-3"],[1,"btn","btn-outline-success","mt-2",3,"click"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"h5",1),e._uU(2," Registro del Producto"),e.qZA(),e._UZ(3,"hr"),e.YNc(4,r,4,2,"div",2),e.YNc(5,c,5,0,"div",3),e.qZA()),2&o&&(e.xp6(4),e.Q6J("ngIf",!i.submitted),e.xp6(1),e.Q6J("ngIf",i.submitted))},dependencies:[t.O5,b.U]}),n})()},{path:"material",component:(()=>{class n{constructor(o,i,a){this.productService=o,this.router=i,this.auth=a,this.currentIndex=-1,this.title="",this.q="",this.queryChange=void 0,this.areaFilter="",this.productMaterials=[],this.auth.user$.subscribe(l=>this.userRole=l?.userRole)}ngOnInit(){history.state.id||this.router.navigate(["/products"]),this.product=history.state,this.product?.materials&&(this.productMaterials=this.product.materials)}filter(){this.queryChange=this.areaFilter?{key:"area",value:this.q,exact:!0}:this.q,this.currentMaterial=void 0,this.currentIndex=-1}onFilterChange(){this.q=void 0}getSelectedElement(o){this.currentMaterial=o.element,this.currentIndex=o.index,this.addMaterialToProduct(this.currentMaterial)}addMaterialToProduct(o){this.productMaterials.find(a=>a.id==o.id)||this.productMaterials.push({name:o.name,id:o.id})}removeMaterialToProduct(o){this.productMaterials.splice(o,1)}editMaterials(){this.product&&this.productMaterials&&this.productService.update(this.product?.id,{materials:this.productMaterials}).then(()=>{alert("Materiales Actualizados Satisfactoriamente"),this.router.navigate(["/products"])})}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(A),e.Y36(g.F0),e.Y36(h.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-product-materials"]],decls:19,vars:7,consts:[[1,"container","mt-5","vh-100"],["role","search",1,"d-flex"],[1,"text-muted","text-nowrap","my-auto"],[1,"ms-5","form-check"],["for","flexCheckDefault",1,"form-check-label"],["type","checkbox","id","flexCheckDefault","name","areaFilter",1,"form-check-input",3,"ngModel","ngModelChange","change"],["class","form-floating ms-2 me-2 w-50",4,"ngIf"],["class","form-control ms-2 me-2 float-end","type","search","name","query","oninput","this.value = this.value.toLowerCase()","placeholder","Buscar por Nombre","aria-label","Search",3,"ngModel","ngModelChange",4,"ngIf"],["type","submit",1,"btn","btn-outline-success","float-end",3,"click"],[1,"list","row","shadow-sm"],["class","col-md-6",4,"ngIf"],["ngClass","userRole ? ['col-md-6', 'col-md-12']",1,"col-md-6"],["class","edit-form",4,"ngIf"],[4,"ngIf"],[1,"form-floating","ms-2","me-2","w-50"],["name","Inventory","id","floatingSelect","aria-label","providers select",1,"form-select",3,"ngModel","ngModelChange"],["disabled","",3,"ngValue"],["ngValue","Corte y Ensamble"],["ngValue","Consumible"],["ngValue","Carpinteria"],["for","floatingSelect"],["type","search","name","query","oninput","this.value = this.value.toLowerCase()","placeholder","Buscar por Nombre","aria-label","Search",1,"form-control","ms-2","me-2","float-end",3,"ngModel","ngModelChange"],[1,"col-md-6"],[3,"path","query","selectedElement"],[1,"edit-form"],[1,"text-muted"],[1,"list-group","mt-3","mb-3"],["class","list-group-item",4,"ngFor","ngForOf"],["type","submit","class","btn btn-success mb-2 rounded-pill",3,"click",4,"ngIf"],[1,"list-group-item"],[1,"d-flex","flex-row","justify-content-between"],[1,"my-auto","mx-1"],[1,"input-group","mx-1"],["type","number","min","1","step","1","oninput","validity.valid||(value='') || Number.isInteger(value);","placeholder","Unidades por Producto","name","UP","aria-label","quantity",1,"form-control","input-sm",3,"ngModel","ngModelChange"],[1,"input-group-text"],[1,"btn-close","my-auto","btn-sm","rounded-pill","float-end",3,"click"],["type","submit",1,"btn","btn-success","mb-2","rounded-pill",3,"click"]],template:function(o,i){1&o&&(e.TgZ(0,"div",0)(1,"form",1)(2,"h4",2),e._uU(3,"Lista de Materiales del Producto"),e.qZA(),e.TgZ(4,"div",3)(5,"label",4),e._uU(6," Filtro por Area "),e.qZA(),e.TgZ(7,"input",5),e.NdJ("ngModelChange",function(l){return i.areaFilter=l})("change",function(){return i.onFilterChange()}),e.qZA()(),e.YNc(8,C,12,2,"div",6),e.YNc(9,B,1,1,"input",7),e.TgZ(10,"button",8),e.NdJ("click",function(){return i.filter()}),e._uU(11,"Buscar"),e.qZA()(),e._UZ(12,"hr"),e.TgZ(13,"div",9),e.YNc(14,S,2,2,"div",10),e.TgZ(15,"div",11),e.YNc(16,k,10,4,"div",12),e.YNc(17,V,4,0,"div",13),e.YNc(18,K,4,0,"div",13),e.qZA()()()),2&o&&(e.xp6(7),e.Q6J("ngModel",i.areaFilter),e.xp6(1),e.Q6J("ngIf",i.areaFilter),e.xp6(1),e.Q6J("ngIf",!i.areaFilter),e.xp6(5),e.Q6J("ngIf",i.userRole),e.xp6(2),e.Q6J("ngIf",i.product),e.xp6(1),e.Q6J("ngIf",!i.product),e.xp6(1),e.Q6J("ngIf",!i.product))},dependencies:[t.mk,t.sg,t.O5,p._Y,p.YN,p.Kr,p.Fj,p.wV,p.Wl,p.EJ,p.JJ,p.JL,p.qQ,p.On,p.F,Z.Q]}),n})()}];let H=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.Bz.forChild(j),g.Bz]}),n})();var $=m(4466);let G=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[t.ez,H,$.m]}),n})()}}]);