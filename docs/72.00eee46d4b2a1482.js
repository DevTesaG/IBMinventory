"use strict";(self.webpackChunkInvFurniture=self.webpackChunkInvFurniture||[]).push([[72],{2121:(E,C,a)=>{a.d(C,{u:()=>x});var e=a(4650),T=a(6895);const t=function(){return["btn-outline-success","rounded-pill"]};let x=(()=>{class d{constructor(){this.btnMessage="Continuar",this.modalMessage="\xbf Desea continuar con este proceso ? ",this.btnType=!1,this.continue=new e.vpe}ngOnInit(){}modalContinue(f){this.continue.emit(f)}}return d.\u0275fac=function(f){return new(f||d)},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-warn-modal"]],inputs:{btnMessage:"btnMessage",modalMessage:"modalMessage",classlist:"classlist",btnType:"btnType"},outputs:{continue:"continue"},decls:17,vars:4,consts:[[1,"container-fluid","my-3","mx-auto"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop",1,"btn",3,"ngClass"],["id","staticBackdrop","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","staticBackdropLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger","rounded-pill",3,"click"],["type","submit","data-bs-dismiss","modal",1,"ms-5","pb-2","btn","btn-success","rounded-pill",3,"click"]],template:function(f,p){1&f&&(e.TgZ(0,"div",0)(1,"button",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h5",6),e._uU(8,"PRECAUCION"),e.qZA(),e.TgZ(9,"button",7),e.NdJ("click",function(){return p.modalContinue(!1)}),e.qZA()(),e.TgZ(10,"div",8),e._uU(11),e.qZA(),e.TgZ(12,"div",9)(13,"button",10),e.NdJ("click",function(){return p.modalContinue(!1)}),e._uU(14,"Abortar"),e.qZA(),e.TgZ(15,"button",11),e.NdJ("click",function(){return p.modalContinue(!0)}),e._uU(16,"Continuar"),e.qZA()()()()()()),2&f&&(e.xp6(1),e.Q6J("ngClass",p.classlist?p.classlist:e.DdM(3,t)),e.xp6(1),e.hij(" ",p.btnMessage," "),e.xp6(9),e.hij(" ",p.modalMessage," "))},dependencies:[T.mk]}),d})()},2072:(E,C,a)=>{a.r(C),a.d(C,{HistoryModule:()=>i});var e=a(6895),T=a(7486),t=a(4650),x=a(798),d=a(4006),h=a(2121),f=a(5748);function p(n,u){if(1&n){const o=t.EpF();t.TgZ(0,"input",15),t.NdJ("ngModelChange",function(Z){t.CHM(o);const v=t.oxw();return t.KtG(v.query=Z)}),t.qZA()}if(2&n){const o=t.oxw();t.Q6J("ngModel",o.query)}}function _(n,u){if(1&n){const o=t.EpF();t.TgZ(0,"div",6)(1,"select",16),t.NdJ("ngModelChange",function(Z){t.CHM(o);const v=t.oxw();return t.KtG(v.query=Z)}),t.TgZ(2,"option",9),t._uU(3,"Todos"),t.qZA(),t.TgZ(4,"option",9),t._uU(5,"Materiales"),t.qZA(),t.TgZ(6,"option",9),t._uU(7,"Productos"),t.qZA(),t.TgZ(8,"option",9),t._uU(9,"Ordenes"),t.qZA()(),t.TgZ(10,"label",10),t._uU(11,"Inventario"),t.qZA()()}if(2&n){const o=t.oxw();t.xp6(1),t.Q6J("ngModel",o.query),t.xp6(1),t.Q6J("ngValue",void 0),t.xp6(2),t.Q6J("ngValue","InvRawMaterial"),t.xp6(2),t.Q6J("ngValue","invFinishedProduct"),t.xp6(2),t.Q6J("ngValue","Orders")}}function P(n,u){1&n&&(t.TgZ(0,"th",18),t._uU(1,"En espera Comprometido"),t.qZA())}function r(n,u){if(1&n&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.waitingCommited)}}function l(n,u){if(1&n&&(t.TgZ(0,"tr")(1,"th",21),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.YNc(7,r,2,1,"td",22),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA()()),2&n){const o=u.$implicit,m=t.oxw(2);t.xp6(2),t.Oqu(o.name),t.xp6(2),t.hij("",o.available," "),t.xp6(2),t.Oqu(o.commited),t.xp6(1),t.Q6J("ngIf","/RMreport"==m.reportPath),t.xp6(2),t.hij(" ",o.waiting,""),t.xp6(2),t.hij(" ",m.invTotal(o),"")}}function c(n,u){if(1&n&&(t.TgZ(0,"table",17)(1,"thead")(2,"tr")(3,"th",18),t._uU(4),t.qZA(),t.TgZ(5,"th",18),t._uU(6,"Disponible"),t.qZA(),t.TgZ(7,"th",18),t._uU(8,"Comprometido"),t.qZA(),t.YNc(9,P,2,0,"th",19),t.TgZ(10,"th",18),t._uU(11,"En espera"),t.qZA(),t.TgZ(12,"th",18),t._uU(13,"Total"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,l,12,6,"tr",20),t.qZA()()),2&n){const o=t.oxw();t.xp6(4),t.Oqu("/FPreport"==o.reportPath?"Producto":"Material"),t.xp6(5),t.Q6J("ngIf","/RMreport"==o.reportPath),t.xp6(6),t.Q6J("ngForOf",o.reports)}}function g(n,u){if(1&n&&(t.TgZ(0,"tr")(1,"th",21),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA()()),2&n){const o=u.$implicit;t.xp6(2),t.Oqu(o.name),t.xp6(2),t.hij("",o.process," "),t.xp6(2),t.Oqu(o.user),t.xp6(2),t.Oqu(o.prior),t.xp6(2),t.Oqu(o.posterior)}}function b(n,u){if(1&n&&(t.TgZ(0,"table",17)(1,"thead")(2,"tr")(3,"th",18),t._uU(4,"Operacion"),t.qZA(),t.TgZ(5,"th",18),t._uU(6,"Proceso"),t.qZA(),t.TgZ(7,"th",18),t._uU(8,"Autoriza"),t.qZA(),t.TgZ(9,"th",18),t._uU(10,"Estado Previo"),t.qZA(),t.TgZ(11,"th",18),t._uU(12,"Estado Posterior"),t.qZA()()(),t.TgZ(13,"tbody"),t.YNc(14,g,11,5,"tr",20),t.qZA()()),2&n){const o=t.oxw();t.xp6(14),t.Q6J("ngForOf",o.reports)}}const A=function(){return["btn-outline-danger","float-end","btn-sm"]},O=[{path:"",component:(()=>{class n{constructor(o){this.audit=o,this.reportPath="/FPreport",this.reportPathChange="/FPreport",this.query=void 0,this.queryChange=void 0}ngOnInit(){}fetchedArray(o){this.reports=o}invTotal(o){return+o.waiting+ +o.commited+ +o.available+(+o.waitingCommited?+o.waitingCommited:0)}deleteAudit(o){!o||this.audit.deleteAll()}rootChanged(o){this.query=void 0,this.queryChange=void 0}filter(){this.queryChange=this.query}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(x.C))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-history-list"]],decls:26,vars:14,consts:[[1,"container","mt-5","vh-100"],["role","search",1,"d-flex"],[1,"text-muted","text-nowrap","my-auto"],["class","form-control ms-2 me-2 float-end","oninput","this.value = this.value.toLowerCase()","type","search","name","query","placeholder","Buscar por Nombre","aria-label","Search",3,"ngModel","ngModelChange",4,"ngIf"],[1,"input-group","ms-2"],["class","form-floating w-50",4,"ngIf"],[1,"form-floating","w-50"],["name","Inventory","id","floatingSelect","aria-label","providers select",1,"form-select",3,"ngModel","ngModelChange","change"],["disabled","",3,"ngValue"],[3,"ngValue"],["for","floatingSelect"],["type","submit",1,"btn","btn-outline-success","float-end","ms-2",3,"click"],["type","button","btnMessage","Eliminar Audiciones","modalMessage","Esta seguro de que desea descargar todas las ordenes terminadas?",3,"classlist","continue"],[3,"path","mode","query","fetchedArray"],["class","table",4,"ngIf"],["oninput","this.value = this.value.toLowerCase()","type","search","name","query","placeholder","Buscar por Nombre","aria-label","Search",1,"form-control","ms-2","me-2","float-end",3,"ngModel","ngModelChange"],["name","Inventory","id","floatingSelect","aria-label","providers select",1,"form-select",3,"ngModel","ngModelChange"],[1,"table"],["scope","col"],["scope","col",4,"ngIf"],[4,"ngFor","ngForOf"],["scope","row"],[4,"ngIf"]],template:function(o,m){1&o&&(t.TgZ(0,"div",0)(1,"form",1)(2,"h4",2),t._uU(3,"Historial Inventario"),t.qZA(),t.YNc(4,p,1,1,"input",3),t.TgZ(5,"div",4),t.YNc(6,_,12,5,"div",5),t.TgZ(7,"div",6)(8,"select",7),t.NdJ("ngModelChange",function(v){return m.reportPath=v})("change",function(v){return m.rootChanged(v)}),t.TgZ(9,"option",8),t._uU(10,"Seleccione Inventario"),t.qZA(),t.TgZ(11,"option",9),t._uU(12,"Inventario Productos"),t.qZA(),t.TgZ(13,"option",9),t._uU(14,"Inventario Materiales"),t.qZA(),t.TgZ(15,"option",9),t._uU(16,"Movimientos"),t.qZA()(),t.TgZ(17,"label",10),t._uU(18,"Inventario"),t.qZA()()(),t.TgZ(19,"button",11),t.NdJ("click",function(){return m.filter()}),t._uU(20,"Buscar"),t.qZA(),t.TgZ(21,"app-warn-modal",12),t.NdJ("continue",function(v){return m.deleteAudit(v)}),t.qZA()(),t._UZ(22,"hr"),t.TgZ(23,"app-pagination",13),t.NdJ("fetchedArray",function(v){return m.fetchedArray(v)}),t.qZA(),t.YNc(24,c,16,3,"table",14),t.YNc(25,b,15,1,"table",14),t.qZA()),2&o&&(t.xp6(4),t.Q6J("ngIf","/audit"!=m.reportPath),t.xp6(2),t.Q6J("ngIf","/audit"==m.reportPath),t.xp6(2),t.Q6J("ngModel",m.reportPath),t.xp6(1),t.Q6J("ngValue",void 0),t.xp6(2),t.Q6J("ngValue","/FPreport"),t.xp6(2),t.Q6J("ngValue","/RMreport"),t.xp6(2),t.Q6J("ngValue","/audit"),t.xp6(6),t.Q6J("classlist",t.DdM(13,A)),t.xp6(2),t.Q6J("path",m.reportPath)("mode",!0)("query",m.queryChange),t.xp6(1),t.Q6J("ngIf","/audit"!=m.reportPath),t.xp6(1),t.Q6J("ngIf","/audit"==m.reportPath))},dependencies:[e.sg,e.O5,d._Y,d.YN,d.Kr,d.Fj,d.EJ,d.JJ,d.JL,d.On,d.F,h.u,f.Q]}),n})()}];let s=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[T.Bz.forChild(O),T.Bz]}),n})();var y=a(4466);let i=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[e.ez,s,d.u5,y.m]}),n})()},798:(E,C,a)=>{a.d(C,{C:()=>p});var e=a(8179),T=a(4004),t=a(7886),x=a(1402),d=a(5577),h=a(4650),f=a(33);let p=(()=>{class _{constructor(r){this.db=r,this.dbPath="/audit",this.objectsRef=r.collection(this.dbPath)}getNextBatch(r,l){return this.db.collection(this.dbPath,l?c=>c.orderBy("timestamp","desc").startAfter(l.timestamp).limit(r):c=>c.orderBy("timestamp","desc").limit(r))}create(r,l,c,g,b,A){var M={name:r,process:l,posterior:g,timestamp:e.EK.fromDate(new Date),user:c};return b&&(M.prior=b),A&&(M.itemId=A),this.objectsRef.add({...M})}update(r,l){return this.objectsRef.doc(r).update(l)}delete(r){return this.objectsRef.doc(r).delete()}deleteAll(){return this.objectsRef.get().pipe((0,T.U)(r=>r.docs),(0,t.u)(),(0,x.j)(500),(0,d.z)(r=>{var l=this.db.firestore.batch();return r.map(c=>l.delete(c.ref)),l.commit()}))}filterByDateBatch(r,l,c,g,b){return console.log(c),this.db.collection(this.dbPath,A=>A.where("timestamp",">=",r).where("timestamp","<=",l).where("name","==",c).orderBy("timestamp","desc").limit(g))}filterByNameBatch(r,l,c){return this.db.collection(this.dbPath,c?g=>g.where("name",">=",r).where("name","<=",r+"\uf8ff").orderBy("name","desc").startAfter(c.name).limit(l):g=>g.where("name",">=",r).where("name","<=",r+"\uf8ff").orderBy("name","desc").limit(l))}filterByCodeBatch(r,l,c){return this.db.collection(this.dbPath,c?g=>g.where("code",">=",r).where("code","<=",r+"\uf8ff").orderBy("code","desc").startAfter(c.code).limit(l):g=>g.where("code",">=",r).where("code","<=",r+"\uf8ff").orderBy("code","desc").limit(l))}}return _.\u0275fac=function(r){return new(r||_)(h.LFG(f.ST))},_.\u0275prov=h.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},5748:(E,C,a)=>{a.d(C,{Q:()=>O});var e=a(4650),T=a(1135),t=a(9646),x=a(3900),d=a(8505),h=a(2622),f=a(6535),p=a(6895);function _(s,y){if(1&s&&(e.TgZ(0,"div",10),e._uU(1),e.qZA()),2&s){const i=e.oxw().$implicit,n=e.oxw(2).$implicit,u=e.oxw(2);e.xp6(1),e.hij(" ",n[i].toDate().toLocaleDateString("es-MX",u.dateOptions)," ")}}function P(s,y){if(1&s&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&s){const i=e.oxw().$implicit,n=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",n[i]," ")}}function r(s,y){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,_,2,1,"div",9),e.YNc(2,P,2,1,"div",4),e.qZA()),2&s){const i=y.$implicit;e.xp6(1),e.Q6J("ngIf","orderDeadline"==i),e.xp6(1),e.Q6J("ngIf","orderDeadline"!=i)}}function l(s,y){if(1&s&&(e.TgZ(0,"span",7),e.YNc(1,r,3,2,"div",8),e.qZA()),2&s){const i=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",i.showParams)}}function c(s,y){if(1&s){const i=e.EpF();e.TgZ(0,"li",5),e.NdJ("click",function(){const u=e.CHM(i),o=u.$implicit,m=u.index,Z=e.oxw(2);return e.KtG(Z.setActiveProduct(o,m))}),e.YNc(1,l,2,1,"span",6),e.qZA()}if(2&s){const i=y.index,n=e.oxw(2);e.ekj("active",i==n.currentIndex),e.xp6(1),e.Q6J("ngIf",n.isFetched)}}function g(s,y){1&s&&(e.TgZ(0,"li")(1,"span"),e._uU(2,"No se encontraron resultados..."),e.qZA()())}function b(s,y){if(1&s&&(e.TgZ(0,"ul",2),e.YNc(1,c,2,3,"li",3),e.ALo(2,"async"),e.YNc(3,g,3,0,"li",4),e.qZA()),2&s){const i=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,2,i.fetchedData$)),e.xp6(2),e.Q6J("ngIf",!i.isFetched)}}function A(s,y){1&s&&(e.TgZ(0,"div"),e._uU(1,"pepe"),e.qZA())}function M(s,y){if(1&s&&(e.TgZ(0,"div",11),e.YNc(1,A,2,0,"div",4),e.ALo(2,"async"),e.qZA()),2&s){const i=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,i.fetchedData$))}}let O=(()=>{class s{constructor(i,n){this.fos=i,this.cache=n,this.selectedElement=new e.vpe,this.fetchedArray=new e.vpe,this.showParams=["name"],this.mode=!1,this.key="name",this.fetchedDataSub$=new T.X((0,t.of)([{}])),this.fetchedData$=(0,t.of)([]),this.dateOptions={weekday:"long",year:"numeric",month:"long",day:"numeric"},this.currentIndex=-1,this.isFetched=!1,this.firstCall=!0,this.disableNext=!1,this.disablePrev=!0,this.queryChange=void 0,this.filterKey="name",this.exact=!1,this.elementPerCall=10}ngOnInit(){this.path||(this.path="/products"),this.fos.pathSetter(this.path),this.filterKey=this.key,this.firstCall=!1,this.fetchedDataSub$=this.cache.getCollection(this.path,this.key,this.queryChange),this.fetchedData$=this.fetchedDataSub$.asObservable().pipe((0,x.w)(i=>i),(0,d.b)({next:i=>{i.length&&i.length>0&&(this.isFetched=!0,this.mode&&this.fetchedArray.emit(i))},error:()=>alert("Error al cargar bases de datos, favor de recargar"),complete:()=>console.log("Complete")}))}setActiveProduct(i,n){this.currentIndex=n,this.selectedElement.emit({element:i,index:n})}nextPage(){var i=this.fos.filterByKeyBatch(this.key,this.queryChange,this.exact).pipe((0,d.b)({next:n=>{n.length&&n.length>0&&(this.isFetched=!0,this.mode&&this.fetchedArray.emit(n))},error:()=>alert("Error al cargar bases de datos, favor de recargar"),complete:()=>console.log("Complete")}));this.fetchedDataSub$.next(i)}resetPagination(){this.disableNext=!1,this.disablePrev=!0,this.currentIndex=-1,this.currentElement=void 0}ngOnChanges(i){this.firstCall||(this.isFetched=!1,i.path&&this.fos.pathSetter(i.path.currentValue),i.query&&(i.query.currentValue instanceof Object?(this.queryChange=i.query.currentValue.value,this.key=i.query.currentValue.key?i.query.currentValue.key:this.filterKey,this.exact=!!i.query.currentValue.exact):(this.queryChange=i.query.currentValue,this.key=this.filterKey,this.exact=!1),console.log(this.key,this.queryChange)),this.filterProducts())}filterProducts(){this.resetPagination(),this.nextPage()}}return s.\u0275fac=function(i){return new(i||s)(e.Y36(f.U),e.Y36(h.Q))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-pagination"]],inputs:{query:"query",path:"path",showParams:"showParams",mode:"mode",key:"key"},outputs:{selectedElement:"selectedElement",fetchedArray:"fetchedArray"},features:[e._Bn([f.U,{provide:"path",useValue:"/RMreport"},h.Q]),e.TTD],decls:2,vars:2,consts:[["class","list-group overflow-auto mt-3 mb-1","style","max-height:70vh;",4,"ngIf"],["class","d-none",4,"ngIf"],[1,"list-group","overflow-auto","mt-3","mb-1",2,"max-height","70vh"],["class","list-group-item",3,"active","click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"list-group-item",3,"click"],["class","d-flex",4,"ngIf"],[1,"d-flex"],[4,"ngFor","ngForOf"],["class","ms-2",4,"ngIf"],[1,"ms-2"],[1,"d-none"]],template:function(i,n){1&i&&(e.YNc(0,b,4,4,"ul",0),e.YNc(1,M,3,3,"div",1)),2&i&&(e.Q6J("ngIf",!n.mode),e.xp6(1),e.Q6J("ngIf",n.mode))},dependencies:[p.sg,p.O5,p.Ov]}),s})()},1402:(E,C,a)=>{a.d(C,{j:()=>x});var e=a(4482),T=a(5403),t=a(8737);function x(d,h=null){return h=h??d,(0,e.e)((f,p)=>{let _=[],P=0;f.subscribe((0,T.x)(p,r=>{let l=null;P++%h==0&&_.push([]);for(const c of _)c.push(r),d<=c.length&&(l=l??[],l.push(c));if(l)for(const c of l)(0,t.P)(_,c),p.next(c)},()=>{for(const r of _)p.next(r);p.complete()},void 0,()=>{_=null}))})}},8179:(E,C,a)=>{a.d(C,{EK:()=>e.EK});var e=a(2810)}}]);