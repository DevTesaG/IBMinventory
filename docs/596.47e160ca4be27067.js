"use strict";(self.webpackChunkInvFurniture=self.webpackChunkInvFurniture||[]).push([[596],{7915:(E,C,l)=>{l.d(C,{U:()=>F});var o=l(4650),h=l(4985),P=l(8179),t=l(6895),a=l(433),T=l(2121);function d(m,b){if(1&m&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&m){const c=o.oxw(2).$implicit;o.xp6(1),o.hij("",c.placeholder," es obligatorio")}}function s(m,b){if(1&m&&(o.TgZ(0,"div",12),o.YNc(1,d,2,1,"div",13),o.qZA()),2&m){o.oxw();const c=o.MAs(2);o.xp6(1),o.Q6J("ngIf",c.errors.required)}}function f(m,b){1&m&&o._UZ(0,"div",14)}const v=function(m){return{"is-invalid":m}};function x(m,b){if(1&m){const c=o.EpF();o.TgZ(0,"div",6)(1,"input",7,8),o.NdJ("ngModelChange",function(_){const O=o.CHM(c).$implicit;return o.KtG(O.value=_)}),o.qZA(),o.YNc(3,s,2,1,"div",9),o.TgZ(4,"label",10),o._uU(5),o.qZA(),o.YNc(6,f,1,0,"div",11),o.qZA()}if(2&m){const c=b.$implicit,g=o.MAs(2),_=o.oxw(2),M=o.MAs(1);o.xp6(1),o.Tol("form-control"+c.classlist),o.Q6J("id",c.label)("name",c.label)("type",c.type)("placeholder",c.placeholder)("ngModel",c.value)("value",c.valueCallback?c.getValue():c.value)("ngClass",o.VKq(14,v,M.submitted&&g.errors))("readonly",_.mode||c.readonly),o.xp6(2),o.Q6J("ngIf",M.submitted&&g.errors),o.xp6(1),o.Q6J("for",c.label),o.xp6(1),o.Oqu(c.placeholder),o.xp6(1),o.Q6J("ngIf","radio"==c.type)}}function Z(m,b){if(1&m&&(o.TgZ(0,"div",4),o.YNc(1,x,7,16,"div",5),o.qZA()),2&m){const c=b.$implicit;o.xp6(1),o.Q6J("ngForOf",c)}}function y(m,b){if(1&m){const c=o.EpF();o.TgZ(0,"div",15)(1,"app-warn-modal",16),o.NdJ("continue",function(_){o.CHM(c);const M=o.oxw();return o.KtG(M.onSubmit(_))}),o.qZA(),o.TgZ(2,"button",17),o.NdJ("click",function(){o.CHM(c);const _=o.oxw(),M=o.MAs(1);return o.KtG(_.onReset(M))}),o._uU(3," Reset "),o.qZA()()}if(2&m){const c=o.oxw();o.xp6(1),o.Q6J("btnMessage",c.btnMes)}}let F=(()=>{class m{constructor(c){this.cdref=c,this.formModel=new o.vpe,this.reject=new o.vpe,this.mode=!1,this.btnMes="Registrar",this.modalMessage="\xbf Desea continuar con este proceso ? ",this.formObj=[[new h.O("Nombre Completo","fullname","text"),new h.O("Nombre de Usuario","username","text")],[new h.O("Correo Electronico","email","text")],[new h.O("Password","password","password"),new h.O("Confirmar Password","Confirm Password","password")],[new h.O("Aceptar los Terminos","Accept Terms","radio","form-check-input",!1)]],this.continue=!1}ngOnInit(){this.initPlaceHolder()}onContinue(c){this.continue=c}initPlaceHolder(){this.placeHolder&&this.formObj.forEach(c=>c.forEach(g=>{if(this.placeHolder){var _=this.placeHolder[g.getLabel()];_ instanceof P.EK&&(_=this.formatDateString(_.toDate().toLocaleDateString())),g.setValue(_)}}))}ngOnChanges(){this.initPlaceHolder()}formatDateString(c){return c.split("/").reverse().join("/").replace(/\//g,"-")}ngAfterContentChecked(){this.cdref.detectChanges()}onSubmit(c){if(this.continue&&c){var g={};this.formObj.flat(2).forEach(_=>g[_.label]=_.value),this.formModel.emit(g)}}onReset(c){this.continue=!1,this.reject.emit(),c.reset()}}return m.\u0275fac=function(c){return new(c||m)(o.Y36(o.sBO))},m.\u0275cmp=o.Xpm({type:m,selectors:[["app-form"]],inputs:{placeHolder:"placeHolder",mode:"mode",btnMes:"btnMes",modalMessage:"modalMessage",formObj:"formObj"},outputs:{formModel:"formModel",reject:"reject"},features:[o.TTD],decls:4,vars:2,consts:[["name","form","novalidate","",3,"ngSubmit"],["f","ngForm"],["class","input-group mb-2",4,"ngFor","ngForOf"],["class","form-group mt-3",4,"ngIf"],[1,"input-group","mb-2"],["class","form-floating",4,"ngFor","ngForOf"],[1,"form-floating"],["required","",3,"id","name","type","placeholder","ngModel","value","ngClass","readonly","ngModelChange"],["input","ngModel"],["class","invalid-feedback",4,"ngIf"],[1,"",3,"for"],["class","mb-4",4,"ngIf"],[1,"invalid-feedback"],[4,"ngIf"],[1,"mb-4"],[1,"form-group","mt-3"],["type","submit","modalMessage","\xbfSeguro que desea crear una nueva orden?",3,"btnMessage","continue"],["type","button",1,"ms-2","btn","btn-outline-danger","rounded-pill",3,"click"]],template:function(c,g){if(1&c){const _=o.EpF();o.TgZ(0,"form",0,1),o.NdJ("ngSubmit",function(){o.CHM(_);const O=o.MAs(1);return o.KtG(O.form.valid&&g.onContinue(!0))}),o.YNc(2,Z,2,1,"div",2),o.YNc(3,y,4,1,"div",3),o.qZA()}2&c&&(o.xp6(2),o.Q6J("ngForOf",g.formObj),o.xp6(1),o.Q6J("ngIf",!g.mode))},dependencies:[t.mk,t.sg,t.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.On,a.F,T.u]}),m})()},2121:(E,C,l)=>{l.d(C,{u:()=>t});var o=l(4650),h=l(6895);const P=function(){return["btn-outline-success","rounded-pill"]};let t=(()=>{class a{constructor(){this.btnMessage="Continuar",this.modalMessage="\xbf Desea continuar con este proceso ? ",this.continue=new o.vpe}ngOnInit(){}modalContinue(d){this.continue.emit(d)}}return a.\u0275fac=function(d){return new(d||a)},a.\u0275cmp=o.Xpm({type:a,selectors:[["app-warn-modal"]],inputs:{btnMessage:"btnMessage",modalMessage:"modalMessage",classlist:"classlist"},outputs:{continue:"continue"},decls:17,vars:4,consts:[[1,"container-fluid","my-3","mx-auto"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop",1,"btn",3,"ngClass"],["id","staticBackdrop","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","staticBackdropLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","submit","data-bs-dismiss","modal",1,"btn","btn-danger","rounded-pill",3,"click"],["type","button","data-bs-dismiss","modal",1,"btn","btn-success","rounded-pill",3,"click"]],template:function(d,s){1&d&&(o.TgZ(0,"div",0)(1,"button",1),o._uU(2),o.qZA(),o.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h5",6),o._uU(8,"PRECAUCION"),o.qZA(),o.TgZ(9,"button",7),o.NdJ("click",function(){return s.modalContinue(!1)}),o.qZA()(),o.TgZ(10,"div",8),o._uU(11),o.qZA(),o.TgZ(12,"div",9)(13,"button",10),o.NdJ("click",function(){return s.modalContinue(!1)}),o._uU(14,"Abortar"),o.qZA(),o.TgZ(15,"button",11),o.NdJ("click",function(){return s.modalContinue(!0)}),o._uU(16,"Continuar"),o.qZA()()()()()()),2&d&&(o.xp6(1),o.Q6J("ngClass",s.classlist?s.classlist:o.DdM(3,P)),o.xp6(1),o.hij(" ",s.btnMessage," "),o.xp6(9),o.hij(" ",s.modalMessage," "))},dependencies:[h.mk]}),a})()},2596:(E,C,l)=>{l.r(C),l.d(C,{ProductModule:()=>Q});var o=l(6895),h=l(9051),P=l(6535),t=l(4650),a=l(433),T=l(5748),d=l(8179),s=l(4985),f=l(33);let v=(()=>{class r{constructor(e){this.db=e,this.dbPath="/products",this.productsRef=e.collection(this.dbPath)}getById(e){return this.productsRef.doc(e).get()}getNextBatch(e,n){return this.db.collection(this.dbPath,n?i=>i.orderBy("timestamp","desc").startAfter(n.timestamp).limit(e):i=>i.orderBy("timestamp","desc").limit(e))}getPrevBatch(e,n,i){return this.db.collection(this.dbPath,u=>u.orderBy("timestamp","desc").startAt(n).endBefore(i).limit(e))}getBatch(e){return this.db.collection(this.dbPath,n=>n.limit(e).orderBy("timestamp","desc"))}getAll(){return this.productsRef}create(e){return this.productsRef.add({...e})}update(e,n){return this.productsRef.doc(e).update(n)}delete(e){return this.productsRef.doc(e).delete()}filterByNameBatch(e,n,i){return this.db.collection(this.dbPath,i?u=>u.where("name",">=",e).where("name","<=",e+"\uf8ff").orderBy("name","desc").startAfter(i.name).limit(n):u=>u.where("name",">=",e).where("name","<=",e+"\uf8ff").orderBy("name","desc").limit(n))}filterByCodeBatch(e,n,i){return this.db.collection(this.dbPath,i?u=>u.where("code",">=",e).where("code","<=",e+"\uf8ff").orderBy("code","desc").startAfter(i.code).limit(n):u=>u.where("code",">=",e).where("code","<=",e+"\uf8ff").orderBy("code","desc").limit(n))}filterByName(e){return this.db.collection(this.dbPath,n=>n.where("name",">=",e).where("name","<=",e+"\uf8ff"))}filterByCode(e){return this.db.collection(this.dbPath,n=>n.where("code",">=",e).where("code","<=",e+"\uf8ff"))}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(f.ST))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var x=l(9898),Z=l(7915);function y(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"div",2)(1,"h4"),t._uU(2,"Producto"),t.qZA(),t.TgZ(3,"app-form",3),t.NdJ("formModel",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.submit(i))})("reject",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onReject())}),t.qZA(),t.TgZ(4,"button",4),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.deleteProduct())}),t._uU(5," Eliminar "),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateProduct())}),t._uU(7," Editar "),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.updateProduct())}),t._uU(9," Materiales "),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(3),t.Q6J("formObj",e.formObj)("mode",!0)("placeHolder",e.currentProduct),t.xp6(5),t.Q6J("state",e.currentProduct),t.xp6(3),t.Oqu(e.message)}}function F(r,p){1&r&&(t.TgZ(0,"div"),t._UZ(1,"br"),t.TgZ(2,"p"),t._uU(3,"No fue posible acceder a este producto..."),t.qZA()())}let m=(()=>{class r{constructor(e,n){this.productService=e,this.reportService=n,this.refreshList=new t.vpe,this.currentProduct={name:"",description:"",code:"",price:0,leadTime:0,stock:0,capacityByTurn:0},this.message="",this.income=0,this.outflow=0,this.formObj=[[new s.O("Nombre","name","text"),new s.O("Codigo","code","text")],[new s.O("Descripcion","description","text")],[new s.O("Precio","price","number")],[new s.O("Cantidad en Inventario","stock","number")],[new s.O("Capacidad por turno","capacityByTurn","number"),new s.O("Tiempo de Produccion","leadTime","number")]]}ngOnInit(){this.message=""}ngOnChanges(){this.message="",this.currentProduct={...this.product}}createInventoryReport(){if(!this.income)return;const e={name:this.currentProduct.name,available:this.currentProduct.stock,commited:0,wating:0,timestamp:d.EK.fromDate(new Date)};this.reportService.create(e)}submit(e){}onReject(){}updateProduct(){this.currentProduct.id&&this.productService.update(this.currentProduct.id,{name:this.currentProduct.name,code:this.currentProduct.code,description:this.currentProduct.description,price:this.currentProduct.price,leadTime:this.currentProduct.leadTime,capacityByTurn:this.currentProduct.capacityByTurn}).then(()=>{this.refreshList.emit(),this.message="The product was updated successfully!"}).catch(n=>console.log(n))}deleteProduct(){this.currentProduct.id&&this.productService.delete(this.currentProduct.id).then(()=>{this.refreshList.emit(),this.message="The product was deleted successfully!"}).catch(e=>console.log(e))}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(v),t.Y36(x.L))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-product-details"]],inputs:{product:"product"},outputs:{refreshList:"refreshList"},features:[t.TTD],decls:2,vars:2,consts:[["class","edit-form",4,"ngIf"],[4,"ngIf"],[1,"edit-form"],["btnMes","Editar Material","modalMessage","\xbfSeguro que desea editar el producto?",3,"formObj","mode","placeHolder","formModel","reject"],["disabled","",1,"btn","btn-danger","rounded-pill",3,"click"],["type","submit","disabled","",1,"btn","btn-success","rounded-pill","mx-2",3,"click"],["routerLink","material",1,"btn","btn-secondary","rounded-pill",3,"state","click"]],template:function(e,n){1&e&&(t.YNc(0,y,12,5,"div",0),t.YNc(1,F,4,0,"div",1)),2&e&&(t.Q6J("ngIf",n.currentProduct),t.xp6(1),t.Q6J("ngIf",!n.currentProduct))},dependencies:[o.O5,h.rH,Z.U]}),r})();function b(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"app-product-details",19),t.NdJ("refreshList",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.refreshList())}),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(1),t.Q6J("product",e.currentProduct)}}function c(r,p){1&r&&(t.TgZ(0,"div"),t._UZ(1,"br"),t.TgZ(2,"p"),t._uU(3,"Seleccione un producto..."),t.qZA()())}let g=(()=>{class r{constructor(){this.title="",this.q="",this.query="",this.codeFilter=!1}ngOnInit(){}refreshList(){this.currentProduct=void 0}filter(){this.q=this.codeFilter?{key:"code",value:this.query}:this.query,this.refreshList()}getSelectedElement(e){this.currentProduct=e.element}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-product-list"]],features:[t._Bn([P.U,{provide:"path",useValue:"/products"}])],decls:26,vars:6,consts:[[1,"container","mt-5","vh-100"],["role","search",1,"d-flex"],[1,"text-muted","text-nowrap"],[1,"ms-5","form-check"],["for","flexCheckDefault",1,"form-check-label"],["type","checkbox","id","flexCheckDefault","name","codeFilter",1,"form-check-input",3,"ngModel","ngModelChange"],["id","query","type","search","name","query","placeholder","Buscar por Nombre o Codigo","aria-label","Search",1,"form-control","ms-2","me-2","float-end",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-outline-success","float-end",3,"click"],[1,"position-fixed","bottom-0","end-0",2,"margin","6rem","z-index","1070"],["routerLink","add",1,"btn","btn-success","btn-lg","rounded-pill"],["fill","#ffffff","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","4vh","height","4vh","viewBox","0 0 47 47",0,"xml","space","preserve","stroke","#ffffff"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["d","M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141 c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27 c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435 c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z"],[1,"list","row","shadow-sm"],[1,"col-md-6"],[3,"path","query","selectedElement"],[4,"ngIf"],[3,"product","refreshList"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"form",1)(2,"h4",2),t._uU(3,"Lista de Productos"),t.qZA(),t.TgZ(4,"div",3)(5,"label",4),t._uU(6," Filtro por Codigo "),t.qZA(),t.TgZ(7,"input",5),t.NdJ("ngModelChange",function(u){return n.codeFilter=u}),t.qZA()(),t.TgZ(8,"input",6),t.NdJ("ngModelChange",function(u){return n.query=u}),t.qZA(),t.TgZ(9,"button",7),t.NdJ("click",function(){return n.filter()}),t._uU(10,"Buscar"),t.qZA()(),t._UZ(11,"hr"),t.TgZ(12,"div",8)(13,"button",9),t.O4$(),t.TgZ(14,"svg",10),t._UZ(15,"g",11)(16,"g",12),t.TgZ(17,"g",13)(18,"g"),t._UZ(19,"path",14),t.qZA()()()()(),t.kcU(),t.TgZ(20,"div",15)(21,"div",16)(22,"app-pagination",17),t.NdJ("selectedElement",function(u){return n.getSelectedElement(u)}),t.qZA()(),t.TgZ(23,"div",16),t.YNc(24,b,2,1,"div",18),t.YNc(25,c,4,0,"div",18),t.qZA()()()),2&e&&(t.xp6(7),t.Q6J("ngModel",n.codeFilter),t.xp6(1),t.Q6J("ngModel",n.query),t.xp6(14),t.Q6J("path","/products")("query",n.q),t.xp6(2),t.Q6J("ngIf",n.currentProduct),t.xp6(1),t.Q6J("ngIf",!n.currentProduct))},dependencies:[o.O5,h.rH,a._Y,a.Fj,a.Wl,a.JJ,a.JL,a.On,a.F,T.Q,m]}),r})();class _{}var M=l(798),O=l(3651);function J(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"div",4)(2,"div",5)(3,"app-form",6),t.NdJ("formModel",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.submit(i))}),t.qZA()()()()}if(2&r){const e=t.oxw();t.xp6(3),t.Q6J("formObj",e.formObj)}}function B(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"div",7)(1,"h4"),t._uU(2,"El producto a sido registrado Satisfactoriamente!"),t.qZA(),t.TgZ(3,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.newProduct())}),t._uU(4,"A\xf1adir Otro"),t.qZA()()}}function q(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"div",14)(1,"select",15),t.NdJ("ngModelChange",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.q=i)}),t.TgZ(2,"option",16),t._uU(3,"Seleccione Inventario"),t.qZA(),t.TgZ(4,"option",17),t._uU(5,"CORTE Y ENSAMBLE"),t.qZA(),t.TgZ(6,"option",18),t._uU(7,"CONSUMIBLE"),t.qZA(),t.TgZ(8,"option",19),t._uU(9,"CARPINTERIA"),t.qZA()(),t.TgZ(10,"label",20),t._uU(11,"Inventario"),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(1),t.Q6J("ngModel",e.q),t.xp6(1),t.Q6J("ngValue",void 0)}}function N(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"input",21),t.NdJ("ngModelChange",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.q=i)}),t.qZA()}if(2&r){const e=t.oxw();t.Q6J("ngModel",e.q)}}function I(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"li",27)(1,"div",28)(2,"span",29),t._uU(3),t.qZA(),t.TgZ(4,"div",30)(5,"input",31),t.NdJ("ngModelChange",function(i){const A=t.CHM(e).$implicit;return t.KtG(A.quantity=i)}),t.qZA(),t.TgZ(6,"span",32),t._uU(7,"U"),t.qZA()(),t.TgZ(8,"button",33),t.NdJ("click",function(){const u=t.CHM(e).index,A=t.oxw(2);return t.KtG(A.removeMaterialToProduct(u))}),t.qZA()()()}if(2&r){const e=p.$implicit;t.xp6(3),t.hij(" ",e.name," "),t.xp6(2),t.Q6J("ngModel",e.quantity)}}function k(r,p){if(1&r){const e=t.EpF();t.TgZ(0,"div",22)(1,"h4"),t._uU(2,"Producto"),t.qZA(),t.TgZ(3,"h3",23),t._uU(4),t.qZA(),t.TgZ(5,"p"),t._uU(6,"Materiales del Producto: "),t.qZA(),t.TgZ(7,"ul",24),t.YNc(8,I,9,2,"li",25),t.qZA(),t.TgZ(9,"button",26),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.editMaterials())}),t._uU(10," Agregar Matriales "),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(4),t.AsE("",e.product.name," - ",e.product.code,""),t.xp6(4),t.Q6J("ngForOf",e.productMaterials)}}function D(r,p){1&r&&(t.TgZ(0,"div"),t._UZ(1,"br"),t.TgZ(2,"p"),t._uU(3,"No fue posible acceder a este producto..."),t.qZA()())}function L(r,p){1&r&&(t.TgZ(0,"div"),t._UZ(1,"br"),t.TgZ(2,"p"),t._uU(3,"Seleccione un producto..."),t.qZA()())}const S=[{path:"",component:g},{path:"add",component:(()=>{class r{constructor(e,n,i,u){this.invFpService=e,this.auditService=n,this.fos=i,this.auth=u,this.product=new _,this.submitted=!1,this.username="anonimo",this.round=w=>Math.round(100*w)/100,this.auth.user$.subscribe(w=>this.username=w?.displayName);var A=new s.O("Capacidad por turno","capacityByTurn","number");this.formObj=[[new s.O("Nombre","name","text"),new s.O("Codigo","code","text")],[new s.O("Descripcion","description","text")],[new s.O("Precio","price","number")],[new s.O("Cantidad en Inventario","stock","number")],[A,new s.O("Tiempo de Produccion","leadTime","number","",w=>w?this.round(1/w):0,[A],0)]]}submit(e){this.product=e,this.saveProduct()}saveProduct(){this.product.timestamp=d.EK.fromDate(new Date),this.fos.create(this.product).then(e=>{this.invFpService.create({available:this.product.stock,commited:0,wating:0}).then(n=>{this.fos.update(e.id,{invId:n.id}),this.auditService.create(_.name,`Crear Producto: ${this.product.name}`,this.username,JSON.stringify(this.product))}),this.submitted=!0})}newProduct(){this.submitted=!1,this.product=new _}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(x.L),t.Y36(M.C),t.Y36(P.U),t.Y36(O.e))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-add-product"]],features:[t._Bn([P.U,{provide:"path",useValue:"/products"}])],decls:6,vars:2,consts:[[1,"container","vh-100"],[1,"text-muted","mt-5"],[4,"ngIf"],["class","mt-3",4,"ngIf"],[1,"card","mt-4","bg-light","shadow-lg","border-0"],[1,"card-body"],["btnMes","Crear Producto","modalMessage","\xbfDesea continuar con la creacion del producto?",3,"formObj","formModel"],[1,"mt-3"],[1,"btn","btn-outline-success","mt-2",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"h5",1),t._uU(2," Registro del Producto"),t.qZA(),t._UZ(3,"hr"),t.YNc(4,J,4,1,"div",2),t.YNc(5,B,5,0,"div",3),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",!n.submitted),t.xp6(1),t.Q6J("ngIf",n.submitted))},dependencies:[o.O5,Z.U]}),r})()},{path:"material",component:(()=>{class r{constructor(e,n){this.productService=e,this.router=n,this.currentIndex=-1,this.title="",this.q="",this.queryChange=void 0,this.areaFilter="",this.productMaterials=[]}ngOnInit(){history.state.id||this.router.navigate(["/products"]),this.product=history.state,this.product?.materials&&(this.productMaterials=this.product.materials)}filter(){this.queryChange=this.areaFilter?{key:"area",value:this.q,exact:!0}:this.q,this.currentMaterial=void 0,this.currentIndex=-1}onFilterChange(){this.q=void 0}getSelectedElement(e){this.currentMaterial=e.element,this.currentIndex=e.index,this.addMaterialToProduct(this.currentMaterial)}addMaterialToProduct(e){this.productMaterials.find(i=>i.id==e.id)||this.productMaterials.push({name:e.name,id:e.id})}removeMaterialToProduct(e){this.productMaterials.splice(e,1)}editMaterials(){this.product&&this.productMaterials&&this.productService.update(this.product?.id,{materials:this.productMaterials}).then(()=>{alert("Materiales Actualizados Satisfactoriamente"),this.router.navigate(["/products"])})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(v),t.Y36(h.F0))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-product-materials"]],decls:20,vars:8,consts:[[1,"container","mt-5","vh-100"],["role","search",1,"d-flex"],[1,"text-muted","text-nowrap","my-auto"],[1,"ms-5","form-check"],["for","flexCheckDefault",1,"form-check-label"],["type","checkbox","id","flexCheckDefault","name","areaFilter",1,"form-check-input",3,"ngModel","ngModelChange","change"],["class","form-floating ms-2 me-2 w-50",4,"ngIf"],["class","form-control ms-2 me-2 float-end","type","search","name","query","placeholder","Buscar por Nombre","aria-label","Search",3,"ngModel","ngModelChange",4,"ngIf"],["type","submit",1,"btn","btn-outline-success","float-end",3,"click"],[1,"list","row","shadow-sm"],[1,"col-md-6"],[3,"path","query","selectedElement"],["class","edit-form",4,"ngIf"],[4,"ngIf"],[1,"form-floating","ms-2","me-2","w-50"],["name","Inventory","id","floatingSelect","aria-label","providers select",1,"form-select",3,"ngModel","ngModelChange"],["disabled","",3,"ngValue"],["ngValue","Corte y Ensamble"],["ngValue","Consumible"],["ngValue","Carpinteria"],["for","floatingSelect"],["type","search","name","query","placeholder","Buscar por Nombre","aria-label","Search",1,"form-control","ms-2","me-2","float-end",3,"ngModel","ngModelChange"],[1,"edit-form"],[1,"text-muted"],[1,"list-group","mt-3","mb-3"],["class","list-group-item",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-success","mb-2","rounded-pill",3,"click"],[1,"list-group-item"],[1,"d-flex","flex-row","justify-content-between"],[1,"my-auto","mx-1"],[1,"input-group","mx-1"],["type","number","placeholder","Unidades por Producto","name","UP","aria-label","quantity",1,"form-control","input-sm",3,"ngModel","ngModelChange"],[1,"input-group-text"],[1,"btn-close","my-auto","btn-sm","rounded-pill","float-end",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"form",1)(2,"h4",2),t._uU(3,"Lista de Materiales del Producto"),t.qZA(),t.TgZ(4,"div",3)(5,"label",4),t._uU(6," Filtro por Area "),t.qZA(),t.TgZ(7,"input",5),t.NdJ("ngModelChange",function(u){return n.areaFilter=u})("change",function(){return n.onFilterChange()}),t.qZA()(),t.YNc(8,q,12,2,"div",6),t.YNc(9,N,1,1,"input",7),t.TgZ(10,"button",8),t.NdJ("click",function(){return n.filter()}),t._uU(11,"Buscar"),t.qZA()(),t._UZ(12,"hr"),t.TgZ(13,"div",9)(14,"div",10)(15,"app-pagination",11),t.NdJ("selectedElement",function(u){return n.getSelectedElement(u)}),t.qZA()(),t.TgZ(16,"div",10),t.YNc(17,k,11,3,"div",12),t.YNc(18,D,4,0,"div",13),t.YNc(19,L,4,0,"div",13),t.qZA()()()),2&e&&(t.xp6(7),t.Q6J("ngModel",n.areaFilter),t.xp6(1),t.Q6J("ngIf",n.areaFilter),t.xp6(1),t.Q6J("ngIf",!n.areaFilter),t.xp6(6),t.Q6J("path","/materials")("query",n.queryChange),t.xp6(2),t.Q6J("ngIf",n.product),t.xp6(1),t.Q6J("ngIf",!n.product),t.xp6(1),t.Q6J("ngIf",!n.product))},dependencies:[o.sg,o.O5,a._Y,a.YN,a.Kr,a.Fj,a.wV,a.Wl,a.EJ,a.JJ,a.JL,a.On,a.F,T.Q]}),r})()}];let j=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[h.Bz.forChild(S),h.Bz]}),r})();var R=l(4466);let Q=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[o.ez,j,R.m]}),r})()},798:(E,C,l)=>{l.d(C,{C:()=>t});var o=l(8179),h=l(4650),P=l(33);let t=(()=>{class a{constructor(d){this.db=d,this.dbPath="/audit",this.objectsRef=d.collection(this.dbPath)}getNextBatch(d,s){return this.db.collection(this.dbPath,s?f=>f.orderBy("timestamp","desc").startAfter(s.timestamp).limit(d):f=>f.orderBy("timestamp","desc").limit(d))}create(d,s,f,v,x,Z){var y={name:d,process:s,posterior:v,timestamp:o.EK.fromDate(new Date),user:f};return x&&(y.prior=x),Z&&(y.itemId=Z),this.objectsRef.add({...y})}update(d,s){return this.objectsRef.doc(d).update(s)}delete(d){return this.objectsRef.doc(d).delete()}filterByDateBatch(d,s,f,v,x){return console.log(f),this.db.collection(this.dbPath,Z=>Z.where("timestamp",">=",d).where("timestamp","<=",s).where("name","==",f).orderBy("timestamp","desc").limit(v))}filterByNameBatch(d,s,f){return this.db.collection(this.dbPath,f?v=>v.where("name",">=",d).where("name","<=",d+"\uf8ff").orderBy("name","desc").startAfter(f.name).limit(s):v=>v.where("name",">=",d).where("name","<=",d+"\uf8ff").orderBy("name","desc").limit(s))}filterByCodeBatch(d,s,f){return this.db.collection(this.dbPath,f?v=>v.where("code",">=",d).where("code","<=",d+"\uf8ff").orderBy("code","desc").startAfter(f.code).limit(s):v=>v.where("code",">=",d).where("code","<=",d+"\uf8ff").orderBy("code","desc").limit(s))}}return a.\u0275fac=function(d){return new(d||a)(h.LFG(P.ST))},a.\u0275prov=h.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},8179:(E,C,l)=>{l.d(C,{EK:()=>o.EK});var o=l(2810)}}]);