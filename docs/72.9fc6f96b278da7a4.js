"use strict";(self.webpackChunkInvFurniture=self.webpackChunkInvFurniture||[]).push([[72],{2121:(O,T,a)=>{a.d(T,{u:()=>x});var e=a(4650),Z=a(6895);const t=function(){return["btn-outline-success","rounded-pill"]};let x=(()=>{class d{constructor(){this.btnMessage="Continuar",this.modalMessage="\xbf Desea continuar con este proceso ? ",this.btnType=!1,this.continue=new e.vpe}ngOnInit(){}modalContinue(g){this.continue.emit(g)}}return d.\u0275fac=function(g){return new(g||d)},d.\u0275cmp=e.Xpm({type:d,selectors:[["app-warn-modal"]],inputs:{btnMessage:"btnMessage",modalMessage:"modalMessage",classlist:"classlist",btnType:"btnType"},outputs:{continue:"continue"},decls:17,vars:4,consts:[[1,"container-fluid","my-3","mx-auto"],["data-bs-toggle","modal","data-bs-target","#staticBackdrop",1,"btn",3,"ngClass"],["id","staticBackdrop","data-bs-backdrop","static","data-bs-keyboard","false","tabindex","-1","aria-labelledby","staticBackdropLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","staticBackdropLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-danger","rounded-pill",3,"click"],["type","submit","data-bs-dismiss","modal",1,"ms-5","pb-2","btn","btn-success","rounded-pill",3,"click"]],template:function(g,u){1&g&&(e.TgZ(0,"div",0)(1,"button",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"h5",6),e._uU(8,"PRECAUCION"),e.qZA(),e.TgZ(9,"button",7),e.NdJ("click",function(){return u.modalContinue(!1)}),e.qZA()(),e.TgZ(10,"div",8),e._uU(11),e.qZA(),e.TgZ(12,"div",9)(13,"button",10),e.NdJ("click",function(){return u.modalContinue(!1)}),e._uU(14,"Abortar"),e.qZA(),e.TgZ(15,"button",11),e.NdJ("click",function(){return u.modalContinue(!0)}),e._uU(16,"Continuar"),e.qZA()()()()()()),2&g&&(e.xp6(1),e.Q6J("ngClass",u.classlist?u.classlist:e.DdM(3,t)),e.xp6(1),e.hij(" ",u.btnMessage," "),e.xp6(9),e.hij(" ",u.modalMessage," "))},dependencies:[Z.mk]}),d})()},2072:(O,T,a)=>{a.r(T),a.d(T,{HistoryModule:()=>E});var e=a(6895),Z=a(2827),t=a(4650),x=a(798),d=a(4006),f=a(2121),g=a(5748);function u(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"input",15),t.NdJ("ngModelChange",function(P){t.CHM(n);const v=t.oxw();return t.KtG(v.query=P)}),t.qZA()}if(2&i){const n=t.oxw();t.Q6J("ngModel",n.query)}}function _(i,h){if(1&i){const n=t.EpF();t.TgZ(0,"div",6)(1,"select",16),t.NdJ("ngModelChange",function(P){t.CHM(n);const v=t.oxw();return t.KtG(v.query=P)}),t.TgZ(2,"option",9),t._uU(3,"Todos"),t.qZA(),t.TgZ(4,"option",9),t._uU(5,"Materiales"),t.qZA(),t.TgZ(6,"option",9),t._uU(7,"Productos"),t.qZA(),t.TgZ(8,"option",9),t._uU(9,"Ordenes"),t.qZA()(),t.TgZ(10,"label",10),t._uU(11,"Inventario"),t.qZA()()}if(2&i){const n=t.oxw();t.xp6(1),t.Q6J("ngModel",n.query),t.xp6(1),t.Q6J("ngValue",void 0),t.xp6(2),t.Q6J("ngValue","InvRawMaterial"),t.xp6(2),t.Q6J("ngValue","invFinishedProduct"),t.xp6(2),t.Q6J("ngValue","Orders")}}function b(i,h){1&i&&(t.TgZ(0,"th",18),t._uU(1,"En espera Comprometido"),t.qZA())}function r(i,h){if(1&i&&(t.TgZ(0,"td"),t._uU(1),t.qZA()),2&i){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.watingCommited)}}function l(i,h){if(1&i&&(t.TgZ(0,"tr")(1,"th",21),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.YNc(7,r,2,1,"td",22),t.TgZ(8,"td"),t._uU(9),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA()()),2&i){const n=h.$implicit,m=t.oxw(2);t.xp6(2),t.Oqu(n.name),t.xp6(2),t.hij("",n.available," "),t.xp6(2),t.Oqu(n.commited),t.xp6(1),t.Q6J("ngIf","/RMreport"==m.reportPath),t.xp6(2),t.hij(" ",n.wating,""),t.xp6(2),t.hij(" ",m.invTotal(n),"")}}function c(i,h){if(1&i&&(t.TgZ(0,"table",17)(1,"thead")(2,"tr")(3,"th",18),t._uU(4),t.qZA(),t.TgZ(5,"th",18),t._uU(6,"Disponible"),t.qZA(),t.TgZ(7,"th",18),t._uU(8,"Comprometido"),t.qZA(),t.YNc(9,b,2,0,"th",19),t.TgZ(10,"th",18),t._uU(11,"En espera"),t.qZA(),t.TgZ(12,"th",18),t._uU(13,"Total"),t.qZA()()(),t.TgZ(14,"tbody"),t.YNc(15,l,12,6,"tr",20),t.qZA()()),2&i){const n=t.oxw();t.xp6(4),t.Oqu("/FPreport"==n.reportPath?"Producto":"Material"),t.xp6(5),t.Q6J("ngIf","/RMreport"==n.reportPath),t.xp6(6),t.Q6J("ngForOf",n.reports)}}function y(i,h){if(1&i&&(t.TgZ(0,"tr")(1,"th",21),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA()()),2&i){const n=h.$implicit;t.xp6(2),t.Oqu(n.name),t.xp6(2),t.hij("",n.process," "),t.xp6(2),t.Oqu(n.user),t.xp6(2),t.Oqu(n.prior),t.xp6(2),t.Oqu(n.posterior)}}function M(i,h){if(1&i&&(t.TgZ(0,"table",17)(1,"thead")(2,"tr")(3,"th",18),t._uU(4,"Operacion"),t.qZA(),t.TgZ(5,"th",18),t._uU(6,"Proceso"),t.qZA(),t.TgZ(7,"th",18),t._uU(8,"Autoriza"),t.qZA(),t.TgZ(9,"th",18),t._uU(10,"Estado Previo"),t.qZA(),t.TgZ(11,"th",18),t._uU(12,"Estado Posterior"),t.qZA()()(),t.TgZ(13,"tbody"),t.YNc(14,y,11,5,"tr",20),t.qZA()()),2&i){const n=t.oxw();t.xp6(14),t.Q6J("ngForOf",n.reports)}}const A=function(){return["btn-outline-danger","float-end","btn-sm"]},C=[{path:"",component:(()=>{class i{constructor(n){this.audit=n,this.reportPath="/FPreport",this.reportPathChange="/FPreport",this.query=void 0,this.queryChange=void 0}ngOnInit(){}fetchedArray(n){this.reports=n}invTotal(n){return n.wating+n.commited+n.available+(n.watingCommited?n.watingCommited:0)}deleteAudit(n){!n||this.audit.deleteAll()}rootChanged(n){this.query=void 0,this.queryChange=void 0}filter(){this.queryChange=this.query}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(x.C))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-history-list"]],decls:26,vars:14,consts:[[1,"container","mt-5","vh-100"],["role","search",1,"d-flex"],[1,"text-muted","text-nowrap","my-auto"],["class","form-control ms-2 me-2 float-end","oninput","this.value = this.value.toLowerCase()","type","search","name","query","placeholder","Buscar por Nombre","aria-label","Search",3,"ngModel","ngModelChange",4,"ngIf"],[1,"input-group","ms-2"],["class","form-floating w-50",4,"ngIf"],[1,"form-floating","w-50"],["name","Inventory","id","floatingSelect","aria-label","providers select",1,"form-select",3,"ngModel","ngModelChange","change"],["disabled","",3,"ngValue"],[3,"ngValue"],["for","floatingSelect"],["type","submit",1,"btn","btn-outline-success","float-end","ms-2",3,"click"],["type","button","btnMessage","Eliminar Audiciones","modalMessage","Esta seguro de que desea descargar todas las ordenes terminadas?",3,"classlist","continue"],[3,"path","mode","query","fetchedArray"],["class","table",4,"ngIf"],["oninput","this.value = this.value.toLowerCase()","type","search","name","query","placeholder","Buscar por Nombre","aria-label","Search",1,"form-control","ms-2","me-2","float-end",3,"ngModel","ngModelChange"],["name","Inventory","id","floatingSelect","aria-label","providers select",1,"form-select",3,"ngModel","ngModelChange"],[1,"table"],["scope","col"],["scope","col",4,"ngIf"],[4,"ngFor","ngForOf"],["scope","row"],[4,"ngIf"]],template:function(n,m){1&n&&(t.TgZ(0,"div",0)(1,"form",1)(2,"h4",2),t._uU(3,"Historial Inventario"),t.qZA(),t.YNc(4,u,1,1,"input",3),t.TgZ(5,"div",4),t.YNc(6,_,12,5,"div",5),t.TgZ(7,"div",6)(8,"select",7),t.NdJ("ngModelChange",function(v){return m.reportPath=v})("change",function(v){return m.rootChanged(v)}),t.TgZ(9,"option",8),t._uU(10,"Seleccione Inventario"),t.qZA(),t.TgZ(11,"option",9),t._uU(12,"Inventario Productos"),t.qZA(),t.TgZ(13,"option",9),t._uU(14,"Inventario Materiales"),t.qZA(),t.TgZ(15,"option",9),t._uU(16,"Movimientos"),t.qZA()(),t.TgZ(17,"label",10),t._uU(18,"Inventario"),t.qZA()()(),t.TgZ(19,"button",11),t.NdJ("click",function(){return m.filter()}),t._uU(20,"Buscar"),t.qZA(),t.TgZ(21,"app-warn-modal",12),t.NdJ("continue",function(v){return m.deleteAudit(v)}),t.qZA()(),t._UZ(22,"hr"),t.TgZ(23,"app-pagination",13),t.NdJ("fetchedArray",function(v){return m.fetchedArray(v)}),t.qZA(),t.YNc(24,c,16,3,"table",14),t.YNc(25,M,15,1,"table",14),t.qZA()),2&n&&(t.xp6(4),t.Q6J("ngIf","/audit"!=m.reportPath),t.xp6(2),t.Q6J("ngIf","/audit"==m.reportPath),t.xp6(2),t.Q6J("ngModel",m.reportPath),t.xp6(1),t.Q6J("ngValue",void 0),t.xp6(2),t.Q6J("ngValue","/FPreport"),t.xp6(2),t.Q6J("ngValue","/RMreport"),t.xp6(2),t.Q6J("ngValue","/audit"),t.xp6(6),t.Q6J("classlist",t.DdM(13,A)),t.xp6(2),t.Q6J("path",m.reportPath)("mode",!0)("query",m.queryChange),t.xp6(1),t.Q6J("ngIf","/audit"!=m.reportPath),t.xp6(1),t.Q6J("ngIf","/audit"==m.reportPath))},dependencies:[e.sg,e.O5,d._Y,d.YN,d.Kr,d.Fj,d.EJ,d.JJ,d.JL,d.On,d.F,f.u,g.Q]}),i})()}];let o=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[Z.Bz.forChild(C),Z.Bz]}),i})();var p=a(4466);let E=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[e.ez,o,d.u5,p.m]}),i})()},798:(O,T,a)=>{a.d(T,{C:()=>u});var e=a(8179),Z=a(4004),t=a(7886),x=a(1402),d=a(5577),f=a(4650),g=a(33);let u=(()=>{class _{constructor(r){this.db=r,this.dbPath="/audit",this.objectsRef=r.collection(this.dbPath)}getNextBatch(r,l){return this.db.collection(this.dbPath,l?c=>c.orderBy("timestamp","desc").startAfter(l.timestamp).limit(r):c=>c.orderBy("timestamp","desc").limit(r))}create(r,l,c,y,M,A){var s={name:r,process:l,posterior:y,timestamp:e.EK.fromDate(new Date),user:c};return M&&(s.prior=M),A&&(s.itemId=A),this.objectsRef.add({...s})}update(r,l){return this.objectsRef.doc(r).update(l)}delete(r){return this.objectsRef.doc(r).delete()}deleteAll(){return this.objectsRef.get().pipe((0,Z.U)(r=>r.docs),(0,t.u)(),(0,x.j)(500),(0,d.z)(r=>{var l=this.db.firestore.batch();return r.map(c=>l.delete(c.ref)),l.commit()}))}filterByDateBatch(r,l,c,y,M){return console.log(c),this.db.collection(this.dbPath,A=>A.where("timestamp",">=",r).where("timestamp","<=",l).where("name","==",c).orderBy("timestamp","desc").limit(y))}filterByNameBatch(r,l,c){return this.db.collection(this.dbPath,c?y=>y.where("name",">=",r).where("name","<=",r+"\uf8ff").orderBy("name","desc").startAfter(c.name).limit(l):y=>y.where("name",">=",r).where("name","<=",r+"\uf8ff").orderBy("name","desc").limit(l))}filterByCodeBatch(r,l,c){return this.db.collection(this.dbPath,c?y=>y.where("code",">=",r).where("code","<=",r+"\uf8ff").orderBy("code","desc").startAfter(c.code).limit(l):y=>y.where("code",">=",r).where("code","<=",r+"\uf8ff").orderBy("code","desc").limit(l))}}return _.\u0275fac=function(r){return new(r||_)(f.LFG(g.ST))},_.\u0275prov=f.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"}),_})()},5748:(O,T,a)=>{a.d(T,{Q:()=>A});var e=a(4650),Z=a(1135),t=a(9646),x=a(3900),d=a(8505),f=a(2622),g=a(6535),u=a(6895);function _(s,C){if(1&s&&(e.TgZ(0,"div",9),e._uU(1),e.qZA()),2&s){const o=e.oxw().$implicit,p=e.oxw(2).$implicit,E=e.oxw(2);e.xp6(1),e.hij(" ",p[o].toDate().toLocaleDateString("es-MX",E.dateOptions)," ")}}function b(s,C){if(1&s&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&s){const o=e.oxw().$implicit,p=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",p[o]," ")}}function r(s,C){if(1&s&&(e.TgZ(0,"div"),e.YNc(1,_,2,1,"div",8),e.YNc(2,b,2,1,"div",3),e.qZA()),2&s){const o=C.$implicit;e.xp6(1),e.Q6J("ngIf","orderDeadline"==o),e.xp6(1),e.Q6J("ngIf","orderDeadline"!=o)}}function l(s,C){if(1&s&&(e.TgZ(0,"span",6),e.YNc(1,r,3,2,"div",7),e.qZA()),2&s){const o=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",o.showParams)}}function c(s,C){if(1&s){const o=e.EpF();e.TgZ(0,"li",4),e.NdJ("click",function(){const E=e.CHM(o),i=E.$implicit,h=E.index,n=e.oxw(2);return e.KtG(n.setActiveProduct(i,h))}),e.YNc(1,l,2,1,"span",5),e.qZA()}if(2&s){const o=C.index,p=e.oxw(2);e.ekj("active",o==p.currentIndex),e.xp6(1),e.Q6J("ngIf",p.isFetched)}}function y(s,C){1&s&&(e.TgZ(0,"li")(1,"span"),e._uU(2,"No se encontraron resultados..."),e.qZA()())}function M(s,C){if(1&s&&(e.TgZ(0,"ul",1),e.YNc(1,c,2,3,"li",2),e.ALo(2,"async"),e.YNc(3,y,3,0,"li",3),e.qZA()),2&s){const o=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,2,o.fetchedData$)),e.xp6(2),e.Q6J("ngIf",!o.isFetched)}}let A=(()=>{class s{constructor(o,p){this.fos=o,this.cache=p,this.selectedElement=new e.vpe,this.fetchedArray=new e.vpe,this.showParams=["name"],this.mode=!1,this.key="name",this.fetchedDataSub$=new Z.X((0,t.of)([{}])),this.fetchedData$=(0,t.of)([]),this.dateOptions={weekday:"long",year:"numeric",month:"long",day:"numeric"},this.currentIndex=-1,this.isFetched=!1,this.firstCall=!0,this.disableNext=!1,this.disablePrev=!0,this.queryChange=void 0,this.filterKey="name",this.exact=!1,this.elementPerCall=10}ngOnInit(){this.path||(this.path="/products"),this.fos.pathSetter(this.path),this.filterKey=this.key,this.firstCall=!1,this.fetchedDataSub$=this.cache.getCollection(this.path,this.key,this.queryChange),this.fetchedData$=this.fetchedDataSub$.asObservable().pipe((0,x.w)(o=>o),(0,d.b)({next:o=>{o.length&&o.length>0&&(this.isFetched=!0,this.mode&&this.fetchedArray.emit(o))},error:()=>alert("Error al cargar bases de datos, favor de recargar"),complete:()=>console.log("Complete")}))}setActiveProduct(o,p){this.currentIndex=p,this.selectedElement.emit({element:o,index:p})}nextPage(){var o=this.fos.filterByKeyBatch(this.key,this.queryChange,this.exact).pipe((0,d.b)({next:p=>{p.length&&p.length>0&&(this.isFetched=!0,this.mode&&this.fetchedArray.emit(p))},error:()=>alert("Error al cargar bases de datos, favor de recargar"),complete:()=>console.log("Complete")}));this.fetchedDataSub$.next(o)}resetPagination(){this.disableNext=!1,this.disablePrev=!0,this.currentIndex=-1,this.currentElement=void 0}ngOnChanges(o){this.firstCall||(this.isFetched=!1,o.path&&this.fos.pathSetter(o.path.currentValue),o.query&&(o.query.currentValue instanceof Object?(this.queryChange=o.query.currentValue.value,this.key=o.query.currentValue.key?o.query.currentValue.key:this.filterKey,this.exact=!!o.query.currentValue.exact):(this.queryChange=o.query.currentValue,this.key=this.filterKey,this.exact=!1),console.log(this.key,this.queryChange)),this.filterProducts())}filterProducts(){this.resetPagination(),this.nextPage()}}return s.\u0275fac=function(o){return new(o||s)(e.Y36(g.U),e.Y36(f.Q))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-pagination"]],inputs:{query:"query",path:"path",showParams:"showParams",mode:"mode",key:"key"},outputs:{selectedElement:"selectedElement",fetchedArray:"fetchedArray"},features:[e._Bn([g.U,{provide:"path",useValue:"/RMreport"},f.Q]),e.TTD],decls:1,vars:1,consts:[["class","list-group overflow-auto mt-3 mb-1","style","max-height:70vh;",4,"ngIf"],[1,"list-group","overflow-auto","mt-3","mb-1",2,"max-height","70vh"],["class","list-group-item",3,"active","click",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"list-group-item",3,"click"],["class","d-flex",4,"ngIf"],[1,"d-flex"],[4,"ngFor","ngForOf"],["class","ms-2",4,"ngIf"],[1,"ms-2"]],template:function(o,p){1&o&&e.YNc(0,M,4,4,"ul",0),2&o&&e.Q6J("ngIf",!p.mode)},dependencies:[u.sg,u.O5,u.Ov]}),s})()},1402:(O,T,a)=>{a.d(T,{j:()=>x});var e=a(4482),Z=a(5403),t=a(8737);function x(d,f=null){return f=f??d,(0,e.e)((g,u)=>{let _=[],b=0;g.subscribe((0,Z.x)(u,r=>{let l=null;b++%f==0&&_.push([]);for(const c of _)c.push(r),d<=c.length&&(l=l??[],l.push(c));if(l)for(const c of l)(0,t.P)(_,c),u.next(c)},()=>{for(const r of _)u.next(r);u.complete()},void 0,()=>{_=null}))})}},8179:(O,T,a)=>{a.d(T,{EK:()=>e.EK});var e=a(2810)}}]);