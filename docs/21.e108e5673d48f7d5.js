"use strict";(self.webpackChunkInvFurniture=self.webpackChunkInvFurniture||[]).push([[21],{3602:(g,f,o)=>{o.d(f,{N:()=>t});class t{}},798:(g,f,o)=>{o.d(f,{C:()=>l});var t=o(8179),_=o(4004),p=o(7886),u=o(1402),m=o(5577),n=o(4650),d=o(33);let l=(()=>{class c{constructor(e){this.db=e,this.dbPath="/audit",this.objectsRef=e.collection(this.dbPath)}getNextBatch(e,s){return this.db.collection(this.dbPath,s?r=>r.orderBy("timestamp","desc").startAfter(s.timestamp).limit(e):r=>r.orderBy("timestamp","desc").limit(e))}create(e,s,r,a,h,P){var v={name:e,process:s,posterior:a,timestamp:t.EK.fromDate(new Date),user:r};return h&&(v.prior=h),P&&(v.itemId=P),this.objectsRef.add({...v})}update(e,s){return this.objectsRef.doc(e).update(s)}delete(e){return this.objectsRef.doc(e).delete()}deleteAll(){return this.objectsRef.get().pipe((0,_.U)(e=>e.docs),(0,p.u)(),(0,u.j)(500),(0,m.z)(e=>{var s=this.db.firestore.batch();return e.map(r=>s.delete(r.ref)),s.commit()}))}filterByDateBatch(e,s,r,a,h){return console.log(r),this.db.collection(this.dbPath,P=>P.where("timestamp",">=",e).where("timestamp","<=",s).where("name","==",r).orderBy("timestamp","desc").limit(a))}filterByNameBatch(e,s,r){return this.db.collection(this.dbPath,r?a=>a.where("name",">=",e).where("name","<=",e+"\uf8ff").orderBy("name","desc").startAfter(r.name).limit(s):a=>a.where("name",">=",e).where("name","<=",e+"\uf8ff").orderBy("name","desc").limit(s))}filterByCodeBatch(e,s,r){return this.db.collection(this.dbPath,r?a=>a.where("code",">=",e).where("code","<=",e+"\uf8ff").orderBy("code","desc").startAfter(r.code).limit(s):a=>a.where("code",">=",e).where("code","<=",e+"\uf8ff").orderBy("code","desc").limit(s))}}return c.\u0275fac=function(e){return new(e||c)(n.LFG(d.ST))},c.\u0275prov=n.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},6535:(g,f,o)=>{o.d(f,{U:()=>p});var t=o(4650),_=o(33);let p=(()=>{class u{constructor(n,d){this.db=n,this.path=d,this.objectRef=n.collection(this.path)}pathSetter(n){this.path=n,this.objectRef=this.db.collection(this.path)}pathGetter(){return this.path}getNextBatch(n,d){return this.db.collection(this.path,d?l=>l.orderBy("timestamp","desc").startAfter(d.timestamp).limit(n):l=>l.orderBy("timestamp","desc").limit(n))}getAll(){return this.objectRef}getByKey(n,d){return this.db.collection(this.path,l=>l.where(n,"==",d))}create(n,d){return d?this.objectRef.doc(d).set(n):this.objectRef.add({...n})}update(n,d){return this.objectRef.doc(n).update(d)}delete(n){return this.objectRef.doc(n).delete()}filterByNameBatch(n,d,l){return this.db.collection(this.path,l?c=>c.where("name",">=",n).where("name","<=",n+"\uf8ff").orderBy("name","desc").startAfter(l.name).limit(d):c=>c.where("name",">=",n).where("name","<=",n+"\uf8ff").orderBy("name","desc").limit(d))}filterUrgent(n,d,l){return this.db.collection(this.path,l?c=>c.where("orderDeadline","<=",n).orderBy("orderDeadline","asc").startAfter(l.name).limit(d):c=>c.where("orderDeadline","<=",n).orderBy("orderDeadline","asc").limit(d))}filterByKeyBatch(n,d,l,c,i){return"orderDeadline"==n?this.filterUrgent(d,l,c):this.db.collection(this.path,c?i?e=>e.where(n,"==",d).orderBy("timestamp","desc").startAfter(c.timestamp).limit(l):e=>e.where(n,">=",d).where(n,"<=",d+"\uf8ff").orderBy(n,"desc").startAfter(c[n]).limit(l):i?e=>e.where(n,"==",d).orderBy("timestamp","desc").limit(l):e=>e.where(n,">=",d).where(n,"<=",d+"\uf8ff").orderBy(n,"desc").limit(l))}}return u.\u0275fac=function(n){return new(n||u)(t.LFG(_.ST),t.LFG("path"))},u.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},490:(g,f,o)=>{o.d(f,{y:()=>d});var t=o(9646),_=o(5698),p=o(4004),u=o(8179),m=o(4650),n=o(33);let d=(()=>{class l{constructor(i){this.db=i,this.dbPath="/RMreport",this.InvRawMaterialsRef=i.collection(this.dbPath)}getNextBatch(i,e){return this.db.collection(this.dbPath,e?s=>s.orderBy("materialId","desc").startAfter(e.materialId).limit(i):s=>s.orderBy("materialId","desc").limit(i))}getAll(){return this.InvRawMaterialsRef}create(i,e){return e?this.InvRawMaterialsRef.doc(e).set(i):this.InvRawMaterialsRef.add({...i})}update(i,e){return console.log("Update",i,e),this.InvRawMaterialsRef.doc(i).update({timestamp:u.EK.fromDate(new Date),...e})}delete(i){return this.InvRawMaterialsRef.doc(i).delete()}getStock(i){return i?this.InvRawMaterialsRef.doc(i).get().pipe((0,_.q)(1),(0,p.U)(s=>({id:s.id,available:s.data()?s.data()?.available:0,wating:s.data()?s.data()?.wating:0,watingCommited:s.data()?s.data()?.watingCommited:0,commited:s.data()?s.data()?.commited:0}))):(0,t.of)({})}filterByDateBatch(i,e,s,r,a){return console.log(s),this.db.collection(this.dbPath,h=>h.where("timestamp",">=",i).where("timestamp","<=",e).orderBy("timestamp","desc").limit(r))}filterByNameBatch(i,e,s){return this.db.collection(this.dbPath,s?r=>r.where("name",">=",i).where("name","<=",i+"\uf8ff").orderBy("name","desc").startAfter(s.name).limit(e):r=>r.where("name",">=",i).where("name","<=",i+"\uf8ff").orderBy("name","desc").limit(e))}filterByCodeBatch(i,e,s){return this.db.collection(this.dbPath,s?r=>r.where("code",">=",i).where("code","<=",i+"\uf8ff").orderBy("code","desc").startAfter(s.code).limit(e):r=>r.where("code",">=",i).where("code","<=",i+"\uf8ff").orderBy("code","desc").limit(e))}}return l.\u0275fac=function(i){return new(i||l)(m.LFG(n.ST))},l.\u0275prov=m.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},5872:(g,f,o)=>{o.d(f,{H:()=>d});var t=o(5861),_=o(4004),p=o(7886),u=o(5577),m=o(4650),n=o(33);let d=(()=>{class l{constructor(i){this.db=i,this.dbPath="/providers",this.ProvidersRef=i.collection(this.dbPath)}getNextBatch(i,e){return this.db.collection(this.dbPath,e?s=>s.orderBy("materialId","desc").startAfter(e.materialId).limit(i):s=>s.orderBy("materialId","desc").limit(i))}getAll(){return this.ProvidersRef}getById(i){return this.ProvidersRef.doc(i).valueChanges({idField:"id"})}create(i){return this.ProvidersRef.add({...i})}update(i,e){return console.log("Update",i,e),this.ProvidersRef.doc(i).update(e)}delete(i){return this.db.collection(this.dbPath,e=>e.where("materialId","==",i)).get().pipe((0,_.U)(e=>e.docs),(0,p.u)(),(0,u.z)(e=>e.ref.delete()))}getProvidersByMaterial(i){var e=this;return(0,t.Z)(function*(){return i?new Promise(function(){var s=(0,t.Z)(function*(r){e.db.collection(e.dbPath,a=>a.where("materialId","==",i)).snapshotChanges().pipe((0,_.U)(a=>a.map(h=>({id:h.payload.doc.id,...h.payload.doc.data()})))).subscribe(a=>{r(a)})});return function(r){return s.apply(this,arguments)}}()):[]})()}filterByNameBatch(i,e,s){return this.db.collection(this.dbPath,s?r=>r.where("name",">=",i).where("name","<=",i+"\uf8ff").orderBy("name","desc").startAfter(s.name).limit(e):r=>r.where("name",">=",i).where("name","<=",i+"\uf8ff").orderBy("name","desc").limit(e))}}return l.\u0275fac=function(i){return new(i||l)(m.LFG(n.ST))},l.\u0275prov=m.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()},5748:(g,f,o)=>{o.d(f,{Q:()=>i});var t=o(4650),_=o(4004),p=o(6535),u=o(6895);function m(e,s){if(1&e&&(t.TgZ(0,"div",15),t._uU(1),t.qZA()),2&e){const r=t.oxw().$implicit,a=t.oxw().$implicit,h=t.oxw(2);t.xp6(1),t.hij(" ",a[r].toDate().toLocaleDateString("es-MX",h.dateOptions)," ")}}function n(e,s){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const r=t.oxw().$implicit,a=t.oxw().$implicit;t.xp6(1),t.hij(" ",a[r]," ")}}function d(e,s){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,m,2,1,"div",13),t.YNc(2,n,2,1,"div",14),t.qZA()),2&e){const r=s.$implicit;t.xp6(1),t.Q6J("ngIf","orderDeadline"==r),t.xp6(1),t.Q6J("ngIf","orderDeadline"!=r)}}function l(e,s){if(1&e){const r=t.EpF();t.TgZ(0,"li",10),t.NdJ("click",function(){const h=t.CHM(r),P=h.$implicit,v=h.index,y=t.oxw(2);return t.KtG(y.setActiveProduct(P,v))}),t.TgZ(1,"span",11),t.YNc(2,d,3,2,"div",12),t.qZA()()}if(2&e){const r=s.index,a=t.oxw(2);t.ekj("active",r==a.currentIndex),t.xp6(2),t.Q6J("ngForOf",a.showParams)}}function c(e,s){if(1&e&&(t.TgZ(0,"ul",8),t.YNc(1,l,3,3,"li",9),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngForOf",r.elementArray)}}let i=(()=>{class e{constructor(r){this.fos=r,this.selectedElement=new t.vpe,this.fetchedArray=new t.vpe,this.showParams=["name"],this.mode=!1,this.key="name",this.dateOptions={weekday:"long",year:"numeric",month:"long",day:"numeric"},this.currentIndex=-1,this.isFetched=!1,this.firstCall=!0,this.disableNext=!1,this.disablePrev=!0,this.updateProducts=!1,this.elementArray=[],this.lastInResponses=[],this.cached=[],this.queryChange=void 0,this.filterKey="name",this.exact=!1,this.elementPerCall=2}ngOnInit(){this.path||(this.path="/products"),this.fos.pathSetter(this.path),this.nextPage(!0),this.filterKey=this.key,this.firstCall=!1}setActiveProduct(r,a){this.currentIndex=a,this.selectedElement.emit({element:r,index:a})}nextPage(r){var a;if(r){if(this.disableNext)return;a=this.elementArray.at(-1),this.lastInResponses.push(a)}else{if(this.disablePrev)return;this.lastInResponses?.pop(),a=this.lastInResponses?.at(-1)}this.req=this.queryChange?this.fos.filterByKeyBatch(this.key,this.queryChange,this.elementPerCall,a,this.exact):this.fos.getNextBatch(this.elementPerCall,a),this.req.get().pipe((0,_.U)(h=>h.docs.map(P=>({id:P.id,...P.data()})))).subscribe({next:h=>{if(!h.length)return this.disableNext=!0,void this.lastInResponses?.pop();this.elementArray=h,this.disableNext=h.length<this.elementPerCall,this.disablePrev=!a,this.isFetched=!0,this.mode&&this.fetchedArray.emit(this.elementArray)},error:h=>alert(h),complete:()=>console.log("SI completo")})}resetPagination(){this.disableNext=!1,this.disablePrev=!0,this.currentIndex=-1,this.currentElement=void 0,this.elementArray=[],this.lastInResponses=[]}ngOnChanges(r){this.firstCall||(this.isFetched=!1,r.path&&this.fos.pathSetter(r.path.currentValue),r.key&&console.log("Key Changed"),r.query&&(r.query.currentValue instanceof Object?(this.queryChange=r.query.currentValue.value,this.key=r.query.currentValue.key?r.query.currentValue.key:this.filterKey,this.exact=!!r.query.currentValue.exact):(this.queryChange=r.query.currentValue,this.key=this.filterKey,this.exact=!1),console.log(this.key,this.queryChange)),this.filterProducts())}filterProducts(){this.resetPagination(),this.nextPage(!0)}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(p.U))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-pagination"]],inputs:{query:"query",path:"path",showParams:"showParams",mode:"mode",key:"key"},outputs:{selectedElement:"selectedElement",fetchedArray:"fetchedArray"},features:[t._Bn([p.U,{provide:"path",useValue:"/RMreport"}]),t.TTD],decls:14,vars:1,consts:[["aria-label","Page navigation",1,"my-3"],[1,"pagination"],[1,"page-item"],["aria-label","Previous",1,"page-link",3,"click"],["aria-hidden","true"],[1,"page-link","text-black"],["aria-label","Next",1,"page-link",3,"click"],["class","list-group mt-3 mb-3",4,"ngIf"],[1,"list-group","mt-3","mb-3"],["class","list-group-item",3,"active","click",4,"ngFor","ngForOf"],[1,"list-group-item",3,"click"],[1,"d-flex"],[4,"ngFor","ngForOf"],["class","ms-2",4,"ngIf"],[4,"ngIf"],[1,"ms-2"]],template:function(r,a){1&r&&(t.TgZ(0,"nav",0)(1,"ul",1)(2,"li",2)(3,"button",3),t.NdJ("click",function(){return a.nextPage(!1)}),t.TgZ(4,"span",4),t._uU(5,"\xab"),t.qZA()()(),t.TgZ(6,"li",2)(7,"span",5),t._uU(8," Anterior/Siguiente Registro"),t.qZA()(),t.TgZ(9,"li",2)(10,"button",6),t.NdJ("click",function(){return a.nextPage(!0)}),t.TgZ(11,"span",4),t._uU(12,"\xbb"),t.qZA()()()()(),t.YNc(13,c,2,1,"ul",7)),2&r&&(t.xp6(13),t.Q6J("ngIf",!a.mode&&a.isFetched))},dependencies:[u.sg,u.O5]}),e})()}}]);