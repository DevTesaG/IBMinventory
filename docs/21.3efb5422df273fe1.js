"use strict";(self.webpackChunkInvFurniture=self.webpackChunkInvFurniture||[]).push([[21],{3602:(P,_,c)=>{c.d(_,{N:()=>e});class e{}},798:(P,_,c)=>{c.d(_,{C:()=>u});var e=c(8179),m=c(4650),p=c(33);let u=(()=>{class f{constructor(s){this.db=s,this.dbPath="/audit",this.objectsRef=s.collection(this.dbPath)}getNextBatch(s,t){return this.db.collection(this.dbPath,t?o=>o.orderBy("timestamp","desc").startAfter(t.timestamp).limit(s):o=>o.orderBy("timestamp","desc").limit(s))}create(s,t,o,i,r,l){var n={name:s,process:t,posterior:i,timestamp:e.EK.fromDate(new Date),user:o};return r&&(n.prior=r),l&&(n.itemId=l),this.objectsRef.add({...n})}update(s,t){return this.objectsRef.doc(s).update(t)}delete(s){return this.objectsRef.doc(s).delete()}filterByDateBatch(s,t,o,i,r){return console.log(o),this.db.collection(this.dbPath,l=>l.where("timestamp",">=",s).where("timestamp","<=",t).where("name","==",o).orderBy("timestamp","desc").limit(i))}filterByNameBatch(s,t,o){return this.db.collection(this.dbPath,o?i=>i.where("name",">=",s).where("name","<=",s+"\uf8ff").orderBy("name","desc").startAfter(o.name).limit(t):i=>i.where("name",">=",s).where("name","<=",s+"\uf8ff").orderBy("name","desc").limit(t))}filterByCodeBatch(s,t,o){return this.db.collection(this.dbPath,o?i=>i.where("code",">=",s).where("code","<=",s+"\uf8ff").orderBy("code","desc").startAfter(o.code).limit(t):i=>i.where("code",">=",s).where("code","<=",s+"\uf8ff").orderBy("code","desc").limit(t))}}return f.\u0275fac=function(s){return new(s||f)(m.LFG(p.ST))},f.\u0275prov=m.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},6535:(P,_,c)=>{c.d(_,{U:()=>p});var e=c(4650),m=c(33);let p=(()=>{class u{constructor(a,s){this.db=a,this.path=s,this.objectRef=a.collection(this.path)}pathSetter(a){this.path=a,this.objectRef=this.db.collection(this.path)}pathGetter(){return this.path}getNextBatch(a,s){return this.db.collection(this.path,s?t=>t.orderBy("timestamp","desc").startAfter(s.timestamp).limit(a):t=>t.orderBy("timestamp","desc").limit(a))}getAll(){return this.objectRef}getByKey(a,s){return this.db.collection(this.path,t=>t.where(a,"==",s))}create(a){return this.objectRef.add({...a})}update(a,s){return this.objectRef.doc(a).update(s)}delete(a){return this.objectRef.doc(a).delete()}filterByNameBatch(a,s,t){return this.db.collection(this.path,t?o=>o.where("name",">=",a).where("name","<=",a+"\uf8ff").orderBy("name","desc").startAfter(t.name).limit(s):o=>o.where("name",">=",a).where("name","<=",a+"\uf8ff").orderBy("name","desc").limit(s))}filterUrgent(a,s,t){return this.db.collection(this.path,t?o=>o.where("orderDeadline","<=",a).orderBy("orderDeadline","asc").startAfter(t.name).limit(s):o=>o.where("orderDeadline","<=",a).orderBy("orderDeadline","asc").limit(s))}filterByKeyBatch(a,s,t,o,i){return"orderDeadline"==a?this.filterUrgent(s,t,o):this.db.collection(this.path,o?i?r=>r.where(a,"==",s).orderBy("timestamp","desc").startAfter(o.timestamp).limit(t):r=>r.where(a,">=",s).where(a,"<=",s+"\uf8ff").orderBy(a,"desc").startAfter(o[a]).limit(t):i?r=>r.where(a,"==",s).orderBy("timestamp","desc").limit(t):r=>r.where(a,">=",s).where(a,"<=",s+"\uf8ff").orderBy(a,"desc").limit(t))}}return u.\u0275fac=function(a){return new(a||u)(e.LFG(m.ST),e.LFG("path"))},u.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},490:(P,_,c)=>{c.d(_,{y:()=>s});var e=c(9646),m=c(4004),p=c(5698),u=c(8179),f=c(4650),a=c(33);let s=(()=>{class t{constructor(i){this.db=i,this.dbPath="/RMreport",this.InvRawMaterialsRef=i.collection(this.dbPath)}getNextBatch(i,r){return this.db.collection(this.dbPath,r?l=>l.orderBy("materialId","desc").startAfter(r.materialId).limit(i):l=>l.orderBy("materialId","desc").limit(i))}getAll(){return this.InvRawMaterialsRef}create(i){return this.InvRawMaterialsRef.add({...i})}update(i,r){return console.log("Update",i,r),this.InvRawMaterialsRef.doc(i).update({timestamp:u.EK.fromDate(new Date),...r})}delete(i){return this.InvRawMaterialsRef.doc(i).delete()}getStock(i){return i?this.db.collection(this.dbPath,l=>l.where("materialId","==",i)).snapshotChanges().pipe((0,m.U)(l=>l.map(n=>({id:n.payload.doc.id,...n.payload.doc.data()}))),(0,m.U)(l=>({id:l.at(0)?.id,available:l.at(0)?.available,wating:l.at(0)?.wating,watingCommited:l.at(0)?.watingCommited,commited:l.at(0)?.commited})),(0,p.q)(1)):(0,e.of)({})}filterByDateBatch(i,r,l,n,d){return console.log(l),this.db.collection(this.dbPath,h=>h.where("timestamp",">=",i).where("timestamp","<=",r).where("name","==",l).orderBy("timestamp","desc").limit(n))}filterByNameBatch(i,r,l){return this.db.collection(this.dbPath,l?n=>n.where("name",">=",i).where("name","<=",i+"\uf8ff").orderBy("name","desc").startAfter(l.name).limit(r):n=>n.where("name",">=",i).where("name","<=",i+"\uf8ff").orderBy("name","desc").limit(r))}filterByCodeBatch(i,r,l){return this.db.collection(this.dbPath,l?n=>n.where("code",">=",i).where("code","<=",i+"\uf8ff").orderBy("code","desc").startAfter(l.code).limit(r):n=>n.where("code",">=",i).where("code","<=",i+"\uf8ff").orderBy("code","desc").limit(r))}}return t.\u0275fac=function(i){return new(i||t)(f.LFG(a.ST))},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},5872:(P,_,c)=>{c.d(_,{H:()=>f});var e=c(5861),m=c(4004),p=c(4650),u=c(33);let f=(()=>{class a{constructor(t){this.db=t,this.dbPath="/providers",this.ProvidersRef=t.collection(this.dbPath)}getNextBatch(t,o){return this.db.collection(this.dbPath,o?i=>i.orderBy("materialId","desc").startAfter(o.materialId).limit(t):i=>i.orderBy("materialId","desc").limit(t))}getAll(){return this.ProvidersRef}getById(t){return this.ProvidersRef.doc(t).valueChanges({idField:"id"})}create(t){return this.ProvidersRef.add({...t})}update(t,o){return console.log("Update",t,o),this.ProvidersRef.doc(t).update(o)}delete(t){return this.ProvidersRef.doc(t).delete()}getProvidersByMaterial(t){var o=this;return(0,e.Z)(function*(){return t?new Promise(function(){var i=(0,e.Z)(function*(r){o.db.collection(o.dbPath,l=>l.where("materialId","==",t)).snapshotChanges().pipe((0,m.U)(l=>l.map(n=>({id:n.payload.doc.id,...n.payload.doc.data()})))).subscribe(l=>{r(l)})});return function(r){return i.apply(this,arguments)}}()):[]})()}filterByNameBatch(t,o,i){return this.db.collection(this.dbPath,i?r=>r.where("name",">=",t).where("name","<=",t+"\uf8ff").orderBy("name","desc").startAfter(i.name).limit(o):r=>r.where("name",">=",t).where("name","<=",t+"\uf8ff").orderBy("name","desc").limit(o))}}return a.\u0275fac=function(t){return new(t||a)(p.LFG(u.ST))},a.\u0275prov=p.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},5748:(P,_,c)=>{c.d(_,{Q:()=>i});var e=c(4650),m=c(4004),p=c(6535),u=c(6895);function f(r,l){if(1&r&&(e.TgZ(0,"div",15),e._uU(1),e.qZA()),2&r){const n=e.oxw().$implicit,d=e.oxw().$implicit,h=e.oxw(2);e.xp6(1),e.hij(" ",d[n].toDate().toLocaleDateString("es-MX",h.dateOptions)," ")}}function a(r,l){if(1&r&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&r){const n=e.oxw().$implicit,d=e.oxw().$implicit;e.xp6(1),e.hij(" ",d[n]," ")}}function s(r,l){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,f,2,1,"div",13),e.YNc(2,a,2,1,"div",14),e.qZA()),2&r){const n=l.$implicit;e.xp6(1),e.Q6J("ngIf","orderDeadline"==n),e.xp6(1),e.Q6J("ngIf","orderDeadline"!=n)}}function t(r,l){if(1&r){const n=e.EpF();e.TgZ(0,"li",10),e.NdJ("click",function(){const h=e.CHM(n),g=h.$implicit,y=h.index,v=e.oxw(2);return e.KtG(v.setActiveProduct(g,y))}),e.TgZ(1,"span",11),e.YNc(2,s,3,2,"div",12),e.qZA()()}if(2&r){const n=l.index,d=e.oxw(2);e.ekj("active",n==d.currentIndex),e.xp6(2),e.Q6J("ngForOf",d.showParams)}}function o(r,l){if(1&r&&(e.TgZ(0,"ul",8),e.YNc(1,t,3,3,"li",9),e.qZA()),2&r){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.elementArray)}}let i=(()=>{class r{constructor(n){this.fos=n,this.selectedElement=new e.vpe,this.fetchedArray=new e.vpe,this.showParams=["name"],this.mode=!1,this.key="name",this.dateOptions={weekday:"long",year:"numeric",month:"long",day:"numeric"},this.currentIndex=-1,this.isFetched=!1,this.firstCall=!0,this.disableNext=!1,this.disablePrev=!0,this.updateProducts=!1,this.elementArray=[],this.lastInResponses=[],this.cached=[],this.queryChange=void 0,this.filterKey="name",this.exact=!1,this.elementPerCall=2}ngOnInit(){this.path||(this.path="/products"),this.fos.pathSetter(this.path),this.nextPage(!0),this.filterKey=this.key,this.firstCall=!1}setActiveProduct(n,d){this.currentIndex=d,this.selectedElement.emit({element:n,index:d})}nextPage(n){var d;if(n){if(this.disableNext)return;d=this.elementArray.at(-1),this.lastInResponses.push(d)}else{if(this.disablePrev)return;this.lastInResponses?.pop(),d=this.lastInResponses?.at(-1)}this.req=this.queryChange?this.fos.filterByKeyBatch(this.key,this.queryChange,this.elementPerCall,d,this.exact):this.fos.getNextBatch(this.elementPerCall,d),this.req.get().pipe((0,m.U)(h=>h.docs.map(g=>({id:g.id,...g.data()})))).subscribe({next:h=>{if(!h.length)return this.disableNext=!0,void this.lastInResponses?.pop();this.elementArray=h,this.disableNext=h.length<this.elementPerCall,this.disablePrev=!d,this.isFetched=!0,this.mode&&this.fetchedArray.emit(this.elementArray)},error:h=>alert(h),complete:()=>console.log("SI completo")})}resetPagination(){this.disableNext=!1,this.disablePrev=!0,this.currentIndex=-1,this.currentElement=void 0,this.elementArray=[],this.lastInResponses=[]}ngOnChanges(n){this.firstCall||(this.isFetched=!1,n.path&&this.fos.pathSetter(n.path.currentValue),n.key&&console.log("Key Changed"),n.query&&(n.query.currentValue instanceof Object?(this.queryChange=n.query.currentValue.value,this.key=n.query.currentValue.key?n.query.currentValue.key:this.filterKey,this.exact=!!n.query.currentValue.exact):(this.queryChange=n.query.currentValue,this.key=this.filterKey,this.exact=!1),console.log(this.key,this.queryChange)),this.filterProducts())}filterProducts(){this.resetPagination(),this.nextPage(!0)}}return r.\u0275fac=function(n){return new(n||r)(e.Y36(p.U))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-pagination"]],inputs:{query:"query",path:"path",showParams:"showParams",mode:"mode",key:"key"},outputs:{selectedElement:"selectedElement",fetchedArray:"fetchedArray"},features:[e._Bn([p.U,{provide:"path",useValue:"/RMreport"}]),e.TTD],decls:14,vars:1,consts:[["aria-label","Page navigation",1,"my-3"],[1,"pagination"],[1,"page-item"],["aria-label","Previous",1,"page-link",3,"click"],["aria-hidden","true"],[1,"page-link","text-black"],["aria-label","Next",1,"page-link",3,"click"],["class","list-group mt-3 mb-3",4,"ngIf"],[1,"list-group","mt-3","mb-3"],["class","list-group-item",3,"active","click",4,"ngFor","ngForOf"],[1,"list-group-item",3,"click"],[1,"d-flex"],[4,"ngFor","ngForOf"],["class","ms-2",4,"ngIf"],[4,"ngIf"],[1,"ms-2"]],template:function(n,d){1&n&&(e.TgZ(0,"nav",0)(1,"ul",1)(2,"li",2)(3,"button",3),e.NdJ("click",function(){return d.nextPage(!1)}),e.TgZ(4,"span",4),e._uU(5,"\xab"),e.qZA()()(),e.TgZ(6,"li",2)(7,"span",5),e._uU(8," Anterior/Siguiente Registro"),e.qZA()(),e.TgZ(9,"li",2)(10,"button",6),e.NdJ("click",function(){return d.nextPage(!0)}),e.TgZ(11,"span",4),e._uU(12,"\xbb"),e.qZA()()()()(),e.YNc(13,o,2,1,"ul",7)),2&n&&(e.xp6(13),e.Q6J("ngIf",!d.mode&&d.isFetched))},dependencies:[u.sg,u.O5]}),r})()}}]);