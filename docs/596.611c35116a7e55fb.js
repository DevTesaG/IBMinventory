"use strict";(self.webpackChunkInvFurniture=self.webpackChunkInvFurniture||[]).push([[596],{2596:(D,h,d)=>{d.r(h),d.d(h,{ProductModule:()=>I});var l=d(6895),p=d(9051),m=d(6535),t=d(4650),s=d(433),f=d(5748),_=d(8179),u=d(4985),C=d(33);let g=(()=>{class r{constructor(e){this.db=e,this.dbPath="/products",this.productsRef=e.collection(this.dbPath)}getById(e){return this.productsRef.doc(e).get()}getNextBatch(e,o){return this.db.collection(this.dbPath,o?n=>n.orderBy("timestamp","desc").startAfter(o.timestamp).limit(e):n=>n.orderBy("timestamp","desc").limit(e))}getPrevBatch(e,o,n){return this.db.collection(this.dbPath,i=>i.orderBy("timestamp","desc").startAt(o).endBefore(n).limit(e))}getBatch(e){return this.db.collection(this.dbPath,o=>o.limit(e).orderBy("timestamp","desc"))}getAll(){return this.productsRef}create(e){return this.productsRef.add({...e})}update(e,o){return this.productsRef.doc(e).update(o)}delete(e){return this.productsRef.doc(e).delete()}filterByNameBatch(e,o,n){return this.db.collection(this.dbPath,n?i=>i.where("name",">=",e).where("name","<=",e+"\uf8ff").orderBy("name","desc").startAfter(n.name).limit(o):i=>i.where("name",">=",e).where("name","<=",e+"\uf8ff").orderBy("name","desc").limit(o))}filterByCodeBatch(e,o,n){return this.db.collection(this.dbPath,n?i=>i.where("code",">=",e).where("code","<=",e+"\uf8ff").orderBy("code","desc").startAfter(n.code).limit(o):i=>i.where("code",">=",e).where("code","<=",e+"\uf8ff").orderBy("code","desc").limit(o))}filterByName(e){return this.db.collection(this.dbPath,o=>o.where("name",">=",e).where("name","<=",e+"\uf8ff"))}filterByCode(e){return this.db.collection(this.dbPath,o=>o.where("code",">=",e).where("code","<=",e+"\uf8ff"))}}return r.\u0275fac=function(e){return new(e||r)(t.LFG(C.ST))},r.\u0275prov=t.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var v=d(9898),P=d(7915);function T(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"div",2)(1,"h4"),t._uU(2,"Producto"),t.qZA(),t.TgZ(3,"app-form",3),t.NdJ("formModel",function(n){t.CHM(e);const i=t.oxw();return t.KtG(i.submit(n))})("reject",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onReject())}),t.qZA(),t.TgZ(4,"button",4),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteProduct())}),t._uU(5," Eliminar "),t.qZA(),t.TgZ(6,"button",5),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.updateProduct())}),t._uU(7," Editar "),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.updateProduct())}),t._uU(9," Materiales "),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(3),t.Q6J("formObj",e.formObj)("mode",!0)("placeHolder",e.currentProduct),t.xp6(5),t.Q6J("state",e.currentProduct),t.xp6(3),t.Oqu(e.message)}}function Z(r,c){1&r&&(t.TgZ(0,"div"),t._UZ(1,"br"),t.TgZ(2,"p"),t._uU(3,"No fue posible acceder a este producto..."),t.qZA()())}let M=(()=>{class r{constructor(e,o){this.productService=e,this.reportService=o,this.refreshList=new t.vpe,this.currentProduct={name:"",description:"",code:"",price:0,leadTime:0,stock:0,capacityByTurn:0},this.message="",this.income=0,this.outflow=0,this.formObj=[[new u.O("Nombre","name","text"),new u.O("Codigo","code","text")],[new u.O("Descripcion","description","text")],[new u.O("Precio","price","number")],[new u.O("Cantidad en Inventario","stock","number")],[new u.O("Capacidad por turno","capacityByTurn","number"),new u.O("Tiempo de Produccion","leadTime","number")]]}ngOnInit(){this.message=""}ngOnChanges(){this.message="",this.currentProduct={...this.product}}createInventoryReport(){if(!this.income)return;const e={name:this.currentProduct.name,available:this.currentProduct.stock,commited:0,wating:0,timestamp:_.EK.fromDate(new Date)};this.reportService.create(e)}submit(e){}onReject(){}updateProduct(){this.currentProduct.id&&this.productService.update(this.currentProduct.id,{name:this.currentProduct.name,code:this.currentProduct.code,description:this.currentProduct.description,price:this.currentProduct.price,leadTime:this.currentProduct.leadTime,capacityByTurn:this.currentProduct.capacityByTurn}).then(()=>{this.refreshList.emit(),this.message="The product was updated successfully!"}).catch(o=>console.log(o))}deleteProduct(){this.currentProduct.id&&this.productService.delete(this.currentProduct.id).then(()=>{this.refreshList.emit(),this.message="The product was deleted successfully!"}).catch(e=>console.log(e))}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(g),t.Y36(v.L))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-product-details"]],inputs:{product:"product"},outputs:{refreshList:"refreshList"},features:[t.TTD],decls:2,vars:2,consts:[["class","edit-form",4,"ngIf"],[4,"ngIf"],[1,"edit-form"],["btnMes","Editar Material","modalMessage","\xbfSeguro que desea editar el producto?",3,"formObj","mode","placeHolder","formModel","reject"],["disabled","",1,"btn","btn-danger","rounded-pill",3,"click"],["type","submit","disabled","",1,"btn","btn-success","rounded-pill","mx-2",3,"click"],["routerLink","material",1,"btn","btn-secondary","rounded-pill",3,"state","click"]],template:function(e,o){1&e&&(t.YNc(0,T,12,5,"div",0),t.YNc(1,Z,4,0,"div",1)),2&e&&(t.Q6J("ngIf",o.currentProduct),t.xp6(1),t.Q6J("ngIf",!o.currentProduct))},dependencies:[l.O5,p.rH,P.U]}),r})();function x(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"app-product-details",19),t.NdJ("refreshList",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.refreshList())}),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(1),t.Q6J("product",e.currentProduct)}}function y(r,c){1&r&&(t.TgZ(0,"div"),t._UZ(1,"br"),t.TgZ(2,"p"),t._uU(3,"Seleccione un producto..."),t.qZA()())}let w=(()=>{class r{constructor(){this.title="",this.q="",this.query="",this.codeFilter=!1}ngOnInit(){}refreshList(){this.currentProduct=void 0}filter(){this.q=this.query,this.refreshList()}getSelectedElement(e){this.currentProduct=e.element}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-product-list"]],features:[t._Bn([m.U,{provide:"path",useValue:"/products"}])],decls:26,vars:6,consts:[[1,"container","mt-5","vh-100"],["role","search",1,"d-flex"],[1,"text-muted","text-nowrap"],[1,"ms-5","form-check"],["for","flexCheckDefault",1,"form-check-label"],["type","checkbox","id","flexCheckDefault","name","codeFilter",1,"form-check-input",3,"ngModel","ngModelChange"],["id","query","type","search","name","query","placeholder","Buscar por Nombre o Codigo","aria-label","Search",1,"form-control","ms-2","me-2","float-end",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-outline-success","float-end",3,"click"],[1,"position-fixed","bottom-0","end-0",2,"margin","6rem","z-index","1070"],["routerLink","add",1,"btn","btn-success","btn-lg","rounded-pill"],["fill","#ffffff","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","4vh","height","4vh","viewBox","0 0 47 47",0,"xml","space","preserve","stroke","#ffffff"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["d","M41.267,18.557H26.832V4.134C26.832,1.851,24.99,0,22.707,0c-2.283,0-4.124,1.851-4.124,4.135v14.432H4.141 c-2.283,0-4.139,1.851-4.138,4.135c-0.001,1.141,0.46,2.187,1.207,2.934c0.748,0.749,1.78,1.222,2.92,1.222h14.453V41.27 c0,1.142,0.453,2.176,1.201,2.922c0.748,0.748,1.777,1.211,2.919,1.211c2.282,0,4.129-1.851,4.129-4.133V26.857h14.435 c2.283,0,4.134-1.867,4.133-4.15C45.399,20.425,43.548,18.557,41.267,18.557z"],[1,"list","row","shadow-sm"],[1,"col-md-6"],[3,"path","query","selectedElement"],[4,"ngIf"],[3,"product","refreshList"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"form",1)(2,"h4",2),t._uU(3,"Lista de Productos"),t.qZA(),t.TgZ(4,"div",3)(5,"label",4),t._uU(6," Filtro por Codigo "),t.qZA(),t.TgZ(7,"input",5),t.NdJ("ngModelChange",function(i){return o.codeFilter=i}),t.qZA()(),t.TgZ(8,"input",6),t.NdJ("ngModelChange",function(i){return o.query=i}),t.qZA(),t.TgZ(9,"button",7),t.NdJ("click",function(){return o.filter()}),t._uU(10,"Buscar"),t.qZA()(),t._UZ(11,"hr"),t.TgZ(12,"div",8)(13,"button",9),t.O4$(),t.TgZ(14,"svg",10),t._UZ(15,"g",11)(16,"g",12),t.TgZ(17,"g",13)(18,"g"),t._UZ(19,"path",14),t.qZA()()()()(),t.kcU(),t.TgZ(20,"div",15)(21,"div",16)(22,"app-pagination",17),t.NdJ("selectedElement",function(i){return o.getSelectedElement(i)}),t.qZA()(),t.TgZ(23,"div",16),t.YNc(24,x,2,1,"div",18),t.YNc(25,y,4,0,"div",18),t.qZA()()()),2&e&&(t.xp6(7),t.Q6J("ngModel",o.codeFilter),t.xp6(1),t.Q6J("ngModel",o.query),t.xp6(14),t.Q6J("path","/products")("query",o.q),t.xp6(2),t.Q6J("ngIf",o.currentProduct),t.xp6(1),t.Q6J("ngIf",!o.currentProduct))},dependencies:[l.O5,p.rH,s._Y,s.Fj,s.Wl,s.JJ,s.JL,s.On,s.F,f.Q,M]}),r})();class b{}var A=d(798);function q(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"div")(1,"div",4)(2,"div",5)(3,"app-form",6),t.NdJ("formModel",function(n){t.CHM(e);const i=t.oxw();return t.KtG(i.submit(n))}),t.qZA()()()()}if(2&r){const e=t.oxw();t.xp6(3),t.Q6J("formObj",e.formObj)}}function J(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"div",7)(1,"h4"),t._uU(2,"El producto a sido registrado Satisfactoriamente!"),t.qZA(),t.TgZ(3,"button",8),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.newProduct())}),t._uU(4,"A\xf1adir Otro"),t.qZA()()}}function k(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"li",18)(1,"div",19)(2,"span",20),t._uU(3),t.qZA(),t.TgZ(4,"div",21)(5,"input",22),t.NdJ("ngModelChange",function(n){const a=t.CHM(e).$implicit;return t.KtG(a.quantity=n)}),t.qZA(),t.TgZ(6,"span",23),t._uU(7,"U"),t.qZA()(),t.TgZ(8,"button",24),t.NdJ("click",function(){const i=t.CHM(e).index,a=t.oxw(2);return t.KtG(a.removeMaterialToProduct(i))}),t.qZA()()()}if(2&r){const e=c.$implicit;t.xp6(3),t.hij(" ",e.name," "),t.xp6(2),t.Q6J("ngModel",e.quantity)}}function F(r,c){if(1&r){const e=t.EpF();t.TgZ(0,"div",13)(1,"h4"),t._uU(2,"Producto"),t.qZA(),t.TgZ(3,"h3",14),t._uU(4),t.qZA(),t.TgZ(5,"p"),t._uU(6,"Materiales del Producto: "),t.qZA(),t.TgZ(7,"ul",15),t.YNc(8,k,9,2,"li",16),t.qZA(),t.TgZ(9,"button",17),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.editMaterials())}),t._uU(10," Agregar Matriales "),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(4),t.AsE("",e.product.name," - ",e.product.code,""),t.xp6(4),t.Q6J("ngForOf",e.productMaterials)}}function B(r,c){1&r&&(t.TgZ(0,"div"),t._UZ(1,"br"),t.TgZ(2,"p"),t._uU(3,"No fue posible acceder a este producto..."),t.qZA()())}function N(r,c){1&r&&(t.TgZ(0,"div"),t._UZ(1,"br"),t.TgZ(2,"p"),t._uU(3,"Seleccione un producto..."),t.qZA()())}const O=[{path:"",component:w},{path:"add",component:(()=>{class r{constructor(e,o,n){this.invFpService=e,this.auditService=o,this.fos=n,this.product=new b,this.submitted=!1,this.round=a=>Math.round(100*a)/100;var i=new u.O("Capacidad por turno","capacityByTurn","number");this.formObj=[[new u.O("Nombre","name","text"),new u.O("Codigo","code","text")],[new u.O("Descripcion","description","text")],[new u.O("Precio","price","number")],[new u.O("Cantidad en Inventario","stock","number")],[i,new u.O("Tiempo de Produccion","leadTime","number","",a=>a?this.round(1/a):0,[i],0)]]}submit(e){this.product=e,this.saveProduct()}saveProduct(){this.product.timestamp=_.EK.fromDate(new Date),this.fos.create(this.product).then(e=>{this.invFpService.create({available:this.product.stock,commited:0,wating:0}).then(o=>{this.fos.update(e.id,{invId:o.id})}),this.submitted=!0})}newProduct(){this.submitted=!1,this.product=new b}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(v.L),t.Y36(A.C),t.Y36(m.U))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-add-product"]],features:[t._Bn([m.U,{provide:"path",useValue:"/products"}])],decls:6,vars:2,consts:[[1,"container","vh-100"],[1,"text-muted","mt-5"],[4,"ngIf"],["class","mt-3",4,"ngIf"],[1,"card","mt-4","bg-light","shadow-lg","border-0"],[1,"card-body"],["btnMes","Crear Producto","modalMessage","\xbfDesea continuar con la creacion del producto?",3,"formObj","formModel"],[1,"mt-3"],[1,"btn","btn-outline-success","mt-2",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"h5",1),t._uU(2," Registro del Producto"),t.qZA(),t._UZ(3,"hr"),t.YNc(4,q,4,1,"div",2),t.YNc(5,J,5,0,"div",3),t.qZA()),2&e&&(t.xp6(4),t.Q6J("ngIf",!o.submitted),t.xp6(1),t.Q6J("ngIf",o.submitted))},dependencies:[l.O5,P.U]}),r})()},{path:"material",component:(()=>{class r{constructor(e,o){this.productService=e,this.router=o,this.currentIndex=-1,this.title="",this.q="",this.queryChange=void 0,this.areaFilter="",this.productMaterials=[]}ngOnInit(){this.product=history.state,this.product?.materials&&(this.productMaterials=this.product.materials)}filter(){this.queryChange=this.q}getSelectedElement(e){this.currentMaterial=e.element,this.currentIndex=e.index,this.addMaterialToProduct(this.currentMaterial)}addMaterialToProduct(e){this.productMaterials.find(n=>n.id==e.id)||this.productMaterials.push({name:e.name,id:e.id})}removeMaterialToProduct(e){this.productMaterials.splice(e,1)}editMaterials(){this.product&&this.productMaterials&&this.productService.update(this.product?.id,{materials:this.productMaterials}).then(()=>{alert("Materiales Actualizados Satisfactoriamente"),this.router.navigate(["products"])})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(g),t.Y36(p.F0))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-product-materials"]],decls:19,vars:7,consts:[[1,"container","mt-5","vh-100"],["role","search",1,"d-flex"],[1,"text-muted","text-nowrap","my-auto"],[1,"ms-5","form-check"],["for","flexCheckDefault",1,"form-check-label"],["type","checkbox","id","flexCheckDefault","name","areaFilter",1,"form-check-input",3,"ngModel","ngModelChange"],["type","search","name","query","placeholder","Buscar por Nombre o Area","aria-label","Search",1,"form-control","ms-2","me-2","float-end",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-outline-success","float-end",3,"click"],[1,"list","row","shadow-sm"],[1,"col-md-6"],[3,"path","query","selectedElement"],["class","edit-form",4,"ngIf"],[4,"ngIf"],[1,"edit-form"],[1,"text-muted"],[1,"list-group","mt-3","mb-3"],["class","list-group-item",4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-success","mb-2","rounded-pill",3,"click"],[1,"list-group-item"],[1,"d-flex","flex-row","justify-content-between"],[1,"my-auto","mx-1"],[1,"input-group","mx-1"],["type","number","placeholder","Unidades por Producto","name","UP","aria-label","quantity",1,"form-control","input-sm",3,"ngModel","ngModelChange"],[1,"input-group-text"],[1,"btn-close","my-auto","btn-sm","rounded-pill","float-end",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"form",1)(2,"h4",2),t._uU(3,"Lista de Materiales del Producto"),t.qZA(),t.TgZ(4,"div",3)(5,"label",4),t._uU(6," Filtro por Area "),t.qZA(),t.TgZ(7,"input",5),t.NdJ("ngModelChange",function(i){return o.areaFilter=i}),t.qZA()(),t.TgZ(8,"input",6),t.NdJ("ngModelChange",function(i){return o.q=i}),t.qZA(),t.TgZ(9,"button",7),t.NdJ("click",function(){return o.filter()}),t._uU(10,"Buscar"),t.qZA()(),t._UZ(11,"hr"),t.TgZ(12,"div",8)(13,"div",9)(14,"app-pagination",10),t.NdJ("selectedElement",function(i){return o.getSelectedElement(i)}),t.qZA()(),t.TgZ(15,"div",9),t.YNc(16,F,11,3,"div",11),t.YNc(17,B,4,0,"div",12),t.YNc(18,N,4,0,"div",12),t.qZA()()()),2&e&&(t.xp6(7),t.Q6J("ngModel",o.areaFilter),t.xp6(1),t.Q6J("ngModel",o.q),t.xp6(6),t.Q6J("path","/materials")("query",o.queryChange),t.xp6(2),t.Q6J("ngIf",o.product),t.xp6(1),t.Q6J("ngIf",!o.product),t.xp6(1),t.Q6J("ngIf",!o.product))},dependencies:[l.sg,l.O5,s._Y,s.Fj,s.wV,s.Wl,s.JJ,s.JL,s.On,s.F,f.Q]}),r})()}];let L=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[p.Bz.forChild(O),p.Bz]}),r})();var S=d(4466);let I=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[l.ez,L,S.m]}),r})()}}]);