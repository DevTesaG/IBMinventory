

<div class="container mt-5 vh-100">

    <form class="d-flex" role="search">
      <h3 class="text-muted text-nowrap my-auto">Registrar orden</h3>
      <div class="ms-5 form-check">
        <label class="form-check-label" for="flexCheckDefault">
          Lista de Clientes
        </label>
        <input class="form-check-input" type="checkbox" [(ngModel)]="displayClients" (change)="showClientList()" id="flexCheckDefault" name="displayClients">
      </div>
        <input class="form-control ms-2 me-2 float-end" type="search" name="query" placeholder="Buscar por Nombre" [(ngModel)]="query" aria-label="Search">
      <button class="btn btn-outline-success float-end" (click)="filterProducts()" type="submit">Buscar</button>
    </form>
    
    <hr>
    
    <div class="list row shadow-sm">
      <div class="col-md-6">
        <h5 class="text-muted mt-1">Productos disponibles:</h5>
        <ul class="list-group mt-3 mb-3">
          <li class="list-group-item" *ngFor="let product of Products; let i = index" [class.active]="i == currentIndex" (click)="setActiveProduct(product, i)">

            <span>
              {{ product.name }}
            </span>

            <button *ngIf="!displayClients" class="btn btn-success btn-sm rounded-pill float-end" (click)="addProductToOrder(product)">
              <span>
                <svg fill="#ffffff" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="20px" height="20px" viewBox="0 0 533.973 533.973" xml:space="preserve">
                  <g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M477.931,52.261c-12.821-12.821-33.605-12.821-46.427,0l-266.96,266.954l-62.075-62.069 c-12.821-12.821-33.604-12.821-46.426,0L9.616,303.572c-12.821,12.821-12.821,33.604,0,46.426l85.289,85.289l46.426,46.426 c12.821,12.821,33.611,12.821,46.426,0l46.426-46.426l290.173-290.174c12.821-12.821,12.821-33.605,0-46.426L477.931,52.261z"></path> </g> </g> </g>
                </svg>
              </span>
            </button>
          </li>
        </ul>
      </div>

      <div class="col-md-6">

      <div *ngIf="order" class="edit-form">
        <h4>Nueva Orden</h4>
    
        <!-- <div class="form-floating mb-2">
          <input
          class="form-control"
          id="name"
          required
          placeholder="name"
          [(ngModel)]="order.name"
          name="name"
          type="text"
          />
          <label for="name">Numero de Orden de Pedido</label>
        </div>

        <div class="form-floating input-group mb-2">
          <input
          class="form-control"
            id="clientName"
            required
            placeholder="description"
            [(ngModel)]="order.clientName"
            name="clientName"
            type="text"
            />
            <label for="clientName">Nombre del Cliente</label>
          </div>
           
        <div class="submit-form">
          <div class="form-floating mb-2">
          <input id="shipDate" class="form-control" name="shipDate" required type="date" [(ngModel)]="order.shipDate"/>
        <label for="shipDate">Fecha de Embarque</label>
      </div>
      
      <div class="input-group ">
        <div class="form-floating input-group mb-2">
          <input
          class="form-control"
          id="productionDays"
          required
          placeholder="description"
          [(ngModel)]="order.productionDays"
          name="productionDays"
          type="number"
          />
          <span class="input-group-text">dias</span>
          <label for="productionDays">Dias de Produccion</label>
        </div>
          
        <div class="form-floating input-group mb-2">
            <input
            class="form-control"
            id="orderInput"
            required
            placeholder="Precio"
            [(ngModel)]="order.orderInput"
            name="orderInput"
            type="number"
            />
            <span class="input-group-text">días</span>
            <label for="orderInput">Pedido de Insumos</label>
          </div>
        </div>
          
          <div class="input-group">
            <div class="form-floating mb-3">
              <input id="rmOrderDeadline" class="form-control" name="rmOrderDeadline" required type="date" [(ngModel)]="order.rmOrderDeadline"/>
              <label for="rmOrderDeadline">Pedido Materia Prima</label>
            </div>
            
            <div class="form-floating mb-3">
              <input id="startProductionDeadline" class="form-control" name="startProductionDeadline" required type="date" [(ngModel)]="order.startProductionDeadline"/>
              <label for="startProductionDeadline">Limite inicio de Produccion</label>
            </div>
          </div>
          
          <div class="form-floating mb-2">
            <input
            class="form-control"
            id="notes"
            required
            placeholder="notes"
            [(ngModel)]="order.notes"
            name="notes"
            type="text"
            />
            <label for="notes">notas</label>
          </div> -->
        
        <app-form [formObj]="formObj" (formModel)="submit($event)" btnMes="Crear Orden" modalMessage="¿Desea continuar con la creacion de la Orden?"></app-form>

        <p>productos de la Orden: </p>

        <ul class="list-group mt-3 mb-3">
          <li class="list-group-item" *ngFor="let product of orderProducts; let j = index">
            <div class="d-flex flex-row justify-content-between">
              
              <span class="my-auto">
                {{product.name}}
              </span>
              
              <div class="input-group">
                  <input type="number" placeholder="Unidades" name="UP" [(ngModel)]="product.quantity" class="form-control input-sm" aria-label="quantity">
                  <span class="input-group-text">U</span>
                  <input type="number" class="input-group-append" readonly placeholder="Disponible en PT" name="stock" [(ngModel)]="product.stock" class="form-control input-sm" aria-label="stock">
                  <span class="input-group-text">U</span>
                  <div class="form-check input-group-append mx-2 my-auto">
                    <label class="form-check-label" for="flexCheckDefault"> Usar PT</label>
                    <input class="form-check-input" readonlys type="checkbox" [ngModel]="product.useFP" id="flexCheckDefault" name="codeFilter">
                    <!-- <input class="form-check-input" readonlys type="checkbox" (change)="useFP(product.id, j)" id="flexCheckDefault" name="codeFilter"> -->
                  </div>
              </div>
          
              <button class="btn-close my-auto btn-sm rounded-pill float-end" (click)="removeProductFromOrder(j)"></button>
            </div>
          </li>
        </ul>

      </div>
        
      <div *ngIf="!order">
        <br />
        <p>Seleccione un producto...</p>
      </div>
    </div>


    <nav aria-label="Page navigation" class="mt-3">
      <ul class="pagination">
        <li class="page-item">
          <button class="page-link" aria-label="Previous" (click)="nextPage(false)">
            <span aria-hidden="true">&laquo;</span>
          </button>
        </li>

        <li class="page-item"> <span class="page-link text-black"> Anterior/Siguiente Registro</span></li>
        <li class="page-item">
          <button class="page-link" aria-label="Next" (click)="nextPage(true)">
            <span aria-hidden="true">&raquo;</span>
          </button>
        </li>
      </ul>
    </nav>
</div>